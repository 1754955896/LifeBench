context = '''
你是一位人类学家，作家，数据分析师。
'''

context2 = '''
你是一位人类学家，数据分析师，规划师。
'''

context3 = '''
你是一位人类学家，心理学家，作家。
'''

template_monthly_analysis = '''
请基于以下人物画像、{month}月的日历、事件数据以及之前月份的重要变化背景，通过增加、删除、调整事件等方式，对事件进行全面分析和优化整理，重点解决事件间的冲突、合理性和整体发展逻辑问题，并结合日历属性和个人画像进行分析与补充，最终生成一个**逻辑连贯、内容丰富、符合人物特征、时间安排合理**的优秀一月事件序列：

## 一、分析要求
1. **事件粒度的数据梳理**：以事件为核心单位，系统梳理月度事件序列，构建人物的完整时间轴，明确事件间的先后关系和发展脉络。你在分析和新增事件时，事件可以不必详细具体，但需知道大概主题和事件流程和安排。

2. **事件合理性分析**：
   - 时空冲突排查：识别并解决事件时间重叠、安排过密或不合理的时间分配或空间、地理冲突
   - 日历属性适配：结合节假日、工作日等日历特征判断事件合理性（如工作事件优先安排在工作日）
   - 人物属性匹配：验证事件内容与人物核心属性（职业、习惯、能力、目标等）的一致性，请注意，有时可接收少量的画像信息没有的事件（如新的活动）或轻微不符合画像（没有明显冲突）的事件（如碰巧遇到），体现1）用户尝试体验新的活动，培养新的爱好 2）用户可能会体验一些自己不喜欢/不适合自己的经历 3）用户的画像发生一定的改变。
   - 事件关联性检查：分析事件间的逻辑关系和因果链条，确保事件发展的连贯性
   - 长跨度事件分析：识别持续时间≥3天的长跨度事件，重点分析其合理性、与其他事件的关系及对月度整体安排的影响

3. **事件丰富性与发展分析**：
   - 事件密度评估：检查重要事件分布的合理性，避免出现过长时间的空白
   - 个人发展轨迹：分析重要事件对人物成长和变化的推动作用，确保事件发展符合人物发展逻辑，人物的变化有在后续事件中得到体现。
   - 故事性丰富性：分析个人的变化发展是否合理，不要一成不变，平衡形成的固定习惯与新变量，但要优先保证真实合理。

4. **缺失重要事件推理新增**：基于人物画像、日历属性和发展逻辑，精准定位并推理应该发生但未提及的事件：
   - **特殊日期事件：节假日（如春节、国庆）、生日、纪念日，寒暑假等**
   - 职业里程碑：项目启动/结束、重要会议、晋升/考核、行业活动等
   - 工作生活体现事件，若某一类事件体现不充分可合理新增事件（如工作、家庭、生活、自我满足、社交、运动健康等）。
   - 季节相关活动：符合季节特征的重要活动（如冬季滑雪、夏季旅游）
   - 长跨度事件：持续时间≥3天的重要事件（如长期项目、旅行、培训、健康治疗等）

5. 注意，事件与事件的发生时间可以重叠，一个人可以并行处理多个事务，只要没有严重冲突（如在家养伤和在外旅行同时发生）即可。此外，事件可能会使画像发生变化，此时可以不严格依赖于画像，而要分析变化。
6. 注意，若事件足够丰富可不增加事件。
7. **注意所有该月事件数据中的事件都应尽量保留，你的任务是通过调整其发生时间和过程方式的描述来消解它们之间的冲突。除非很不合理才删除），在输出最终结果前，请对照输入的事件ID数组，确保每个输入事件ID都被处理（要么保留，要么修改/删除）而不要被遗漏。**

## 二、优化要求
### 1. 总体原则
- **最小调整原则**：对事件的调整应遵循最小干预原则，尽量减少修改操作，保持原有事件的完整性和真实性
- **优先重写修改**：对于需要调整的事件，优先采用重写修改（包括调整发生时间和方式和描述）的方式，而非删除后重新添加
- **非必要不删除**：尽量保留所有原事件，避免删除。对于需要调整的事件，优先考虑整合或重写，而非直接删除
- **事件完整性**：确保所有分析后认为合理的事件都被完整输出，避免遗漏

### 2. 新增事件规则
基于合理推理和重要性原则，参考下面的类别，添加各种可能的事件：
- **重要日期相关事件**：
  - 节假日事件：春节、国庆、中秋，寒暑假等重要节日的相关活动
  - 纪念日事件：生日、结婚纪念日、毕业纪念日等有特殊意义的事件
  - 季节特征事件：符合季节特点的重要活动（如春节期间的家庭团聚、夏季的旅行计划）

- **逻辑衔接的关键事件**：
  - 增强发展连贯性：添加与已有重要事件形成因果关系或逻辑衔接的关键事件
  - 填补重要事件空白：在过长时间的重要事件空白期添加符合发展逻辑的重要事件
  - 特殊情境补充：在特定情境下合理添加推动人物发展的重要事件

**特别说明**：新增事件的持续时间可以跨月，例如一次旅行可以从1月28日持续到2月3日。

### 3. 删除事件规则
仅在事件严重不合理或与其他事件存在不可调和冲突时考虑删除：
**优先检查日历并删除严重幻觉事件（如日历不包含春节/中期节等节日但是有相关事件，则必须删除）
其他类别矛盾先思考能否改写使其不冲突，若实在无法改写则删除。
- **矛盾冲突类**：
  - 时间冲突：优先保留重要事件，删除或调整次要事件
  - 地点矛盾：删除或调整同一时间段在不同地点同时发生的事件，优先保留更重要的事件
  - 逻辑矛盾：删除前后因果关系不成立的事件，特别是影响重要事件发展逻辑的冲突

- **不合适类**：
  - 与人物画像不符：删除与人物职业、习惯、能力、目标严重不符的事件
  - 与日历属性不符：删除在节假日安排的不合理工作事件或在工作日安排的不合理休闲事件，特别是影响重要日期事件的安排
  - 重复冗余：删除内容重复或过于相似的事件，优先保留记录更完整或更重要事件

- **不真实类**：
  - 不符合常理：删除现实中不可能发生的事件
  - 时间不合理：删除时间安排过于紧凑或不现实的事件
  - 对现实人物来说过于违和的事件

### 4. 调整事件规则
对于需要调整的事件，优先采用重写修改的方式，修改事件的描述、时间、地点等属性，使其更合理：
- **跨月事件处理**：原来发生时间跨月的事件应保持跨月状态，不要将截止时间缩短到本月最后一日
- **时间调整**：
  - 解决时间冲突：将冲突事件调整到合理的时间
  - 优化时间分配：调整事件的时长，避免过长或过短
  - 日历属性适配：将事件调整到更合适的工作日或节假日
  - 自然衔接：调整事件时间，确保事件间的合理过渡
  - 长跨度事件特殊处理：对于持续时间≥3天的长跨度事件，确保其时间安排合理，与其他重要事件不冲突，并适当调整相关的短期事件安排

- **内容调整**：
  - 补充缺失信息：添加事件的地点、参与人员、具体内容、事件目的等关键信息
  - 优化描述：使事件描述更简洁明了、具体生动
  - 增强逻辑性：调整事件内容，使其更符合因果关系和发展逻辑

- **结构调整**：
  - 整合相关事件：将强相关的事件整合为完整的事件序列
  - 调整事件顺序：优化事件的先后顺序，使其更符合逻辑
  - 增强关联性：调整事件内容，使其与其他事件形成更好的关联

## 输出格式要求
严格按照以下JSON格式输出优化后的月度事件序列，确保格式规范且内容完整，重点体现事件的增减调整情况和整体发展逻辑：
{{
  "month": "{month}",
  "summary": "该月的综合总结，包括重要事件和这个月这个人总体来说做了什么，发生了什么变化",
  "analysis": "详细说明事件的修改策略及原因：\n1. 新增事件：列出新增的事件及其原因\n2. 删除事件：说明删除的事件及原因\n3. 调整事件：描述事件调整的具体内容和理由\n4. 优化效果：总结整体优化对事件质量、合理性和发展逻辑的提升",
  "events": [
    {{   
      "id": "事件ID，原事件保留原有ID，新增事件ID为0",
      "name": "事件名称，需简洁明了，与描述内容相关",
      "description": "完整的事件描述，需详细介绍事件流程，影响等信息，越详细完整越好。",
      "date": ["事件发生的日期范围，格式：YYYY-MM-DD至YYYY-MM-DD"],
      "type": "事件类型，**必须从以下9个类别中选择**：Career（职业工作）、Education（教育学习）、Relationships（人际关系）、Family&Living Situation（家庭生活与居住环境）、Personal Life（自我关怀、娱乐与生活方式）、Finance（个人资产财务）、Health（健康管理）、Unexpected Events（突发应对）、Other（其他未涉及类别）"
    }}
  ]
}}

**事件类型说明**：
- **Career**：职业工作相关（如"参加行业高峰论坛""参与新产品研发项目"）
- **Education**：教育学习相关（如"上课""考取专业资格证"，学生角色该类事件较多，其他角色相关事件会较少）
- **Relationships**：人际关系（如"为父母筹备生日宴""组织闺蜜旅行"）
- **Family&Living Situation**：家庭生活与居住环境（如"家居装修""智能家居安装"）
- **Personal Life**：自我关怀、娱乐与生活方式（SelfCare & Entertainment & Lifesyle）（如"定期SPA护理""短途旅行""组织同学聚会"）
- **Finance**：个人资产财务（如"购买理财产品""汽车保养与维修"）
- **Health**：健康管理（如"中医调理""瑜伽静修营"）
- **Unexpected Events**：突发应对（如"车辆小事故处理""临时加班替班"）
- **Other**：其他未涉及类别

**事件格式详细说明**：
1. 事件粒度：所有事件粒度均为≥1天
2. 日期格式：使用数组表示事件发生的日期范围，如["2025-01-10至2025-01-17"]，支持跨月事件，如["2025-01-28至2025-02-03"]
3. 多次发生：同一事件可多次发生，日期数组中可包含多个日期范围
4. 并行发生：允许多个事件并行发生，它们将作为独立条目出现在events数组中
5. 事件保留：对于分析后认为合理的事件，应完整保留其信息,对于选择保留的事件应尽量不改变描述。
6. 事件类型：**必须从指定的9个类别中选择**，根据事件内容和人物画像进行准确分类

**特别注意**：
1. **最小调整原则**：遵循最小干预原则，尽量减少修改操作，保持原有事件的完整性
2. **优先重写修改**：对于需要调整的事件，优先采用重写方式，而非删除后重新添加
3. **非必要不删除**：尽量保留所有原事件，避免删除。对于需要调整的事件，优先考虑整合或重写，而非直接删除
4. **事件完整性**：确保所有分析后认为合理的事件都被完整输出，避免遗漏
5. **原事件检查**：在生成最终结果前，必须检查原事件数据中的所有事件，确保没有遗漏任何事件，除非该事件被判定为严重不合理
6. **月度事件数量要求**：每月事件列表中应包含至少15个事件，确保事件序列内容丰富、完整反映人物月度活动
7. **ID处理**：原事件保留原有ID，新增事件的ID设为0
8. **跨月事件处理**：原来发生时间跨月的事件应保持跨月状态，不要将截止时间缩短到本月最后一日
9. 在JSON字符串值中避免使用双引号，如果需要表示引号，请使用[]或其他替代符号，或者使用转义字符\n
10. 严格遵循JSON格式规范，确保输出可被正确解析
11. 仅输出JSON格式内容，直接以{{}}作为开头结尾
12. 不添加任何额外文本、注释或代码块标记

---
{month}月的日历数据：{calendar_data}
人物在{month}月的事件数据：{monthly_data}
## 重要变化背景（指人物画像数据到目前为止有什么改变）
{profile_changes_context}

## 上月结束状态（指上个月最后一天的位置和活动）
{previous_month_final_status}
人物画像数据：{persona_data}
事件ID数组（供最后检查用）：{event_ids}

'''

template_category_optimization = '''
请基于以下人物在{month}月的{category}类别事件，对事件进行优化整理：

## 类别定义
{category_definition}

## 事件参考信息
以下是{category}类别的事件参考信息，包含该类别下的阶段事件、原子事件和可感知/可复用行为：
{category_reference}

## 分析要求
1. **事件发展与变化分析**：从{category}的角度，分析这个人一个月的事件如何发展，个人发生了什么样的变化
2. **类别体现与合理性评估**：评估{category}角度是否有很好的体现出来，是否一成不变，目前这个角度看事件是否合理
3. **事件补充建议**：考虑如何新增该类别的事件来展现该类别个人的一个月生活
4. **事件丰富性与发展合理性分析**：分析现在在这个类别，事件是否丰富，体现出来的一个月的发展变化是否合理

## 优化要求
1. **事件补充与多样性提升**：补充必要的{category}事件以保障该类别事件的多样性和真实性，体现个人在该领域的全面发展。新增事件不一定需要基于原事件，可以完全独立添加，与其他事件无关。**注意：新增事件总数不应超过5个，且应尽量避免与已有事件重复相似**。
2. **不合理事件处理**：对于不合理的事件选择删除或调整
3. **事件质量优化**：提升事件描述的质量，使其更加具体、生动，突出{category}相关的特点和变化
4. **事件关联性增强**：加强{category}事件之间的关联关系，体现该领域发展的连贯性和整体性（此要求仅适用于可关联的事件，独立新增的事件无需遵循此要求）

## 输出格式要求
请严格按照以下JSON格式输出优化后的操作结果、月度总结和修改原因：

**特别说明：** 若已有事件已合理多样，或该人物无类别相关事件（如学生不会有工作，工人不会有学习，穷人不会有资产），可以输出空的operations数组。
{{
  "month": "{month}",
  "category": "{category}",
  "operations": [
    {{
      "action": "add",
      "event": {{
        "name": "事件名称，需简洁明了，与描述内容相关",
        "description": "完整的事件描述，需包含事件地点、参与人员、具体内容、事件目的等关键信息",
        "date": ["事件发生的日期范围，格式：YYYY-MM-DD至YYYY-MM-DD"],
        "type": "{category}"
      }}
    }},
    {
      "action": "rewrite",
      "original_event": {{
        "name": "原始事件名称"
      }},
      "new_event": {{
        "name": "修改后的事件名称",
        "description": "修改后的事件描述",
        "date": ["事件发生的日期范围"],
        "type": "{category}"
      }}
    }}
  ],
  "monthly_summary": "从{category}角度出发，串联所有事件，总结该人物一个月的{category}相关生活描述。请使用流畅的语言将事件按时间顺序或逻辑关系串联起来，形成完整的月度{category}画像。",
  "modification_reasons": [
    "针对每项操作（add/rewrite），说明具体的修改原因。请清晰列出每项修改的理由，解释为什么进行该修改以及预期达到的效果。"
  ]
}}

---
人物在{month}月的{category}类别事件：{original_events}
'''

# 类别定义
category_definitions = {
    "Career": "职业工作相关，包括工作任务、职业发展、职场关系、技能提升、项目管理、行业活动等与职业发展和工作相关的各类事件",
    "Education": "教育学习相关，包括课程学习、考试认证、技能培训、学术研究、知识获取等与教育和学习相关的各类事件",
    "Relationships": "人际关系相关，包括亲情、友情、爱情、社交活动、人际互动、情感交流等与人际关系发展相关的各类事件",
    "Family&Living Situation": "家庭生活与居住环境相关，包括家庭日常、居住环境、家居布置、家庭活动、生活设施、家庭责任、家庭氛围、居住体验、生活习惯、家庭事务、家庭关系等与家庭生活和居住环境相关的各类事件",
    "Personal Life": "自我关怀、娱乐与生活方式相关，包括休闲娱乐、自我提升、兴趣爱好、社交活动、身心健康、生活品质、个人成长、情感体验、生活习惯、个人规划等与个人生活质量和幸福感相关的各类事件",
    "Finance": "个人资产财务相关，包括收入来源、支出管理、投资理财、资产配置、消费习惯、财务规划、债务管理、保险保障、税务规划、财务目标等与个人财务状况和管理相关的各类事件",
    "Health": "健康管理相关，包括运动锻炼、健康饮食、养生保健、医疗检查、心理健康、生活习惯、康复训练、健康目标等与身心健康相关的各类事件",
    "Unexpected Events": "突发应对相关，包括意外事件、紧急情况、临时变化、危机处理等需要即时应对的各类事件",
    "Other": "其他未涉及类别，包括不属于上述任何类别的事件"
}

# 每个类别的单独prompt模板
template_career_optimization = '''
请基于以下信息对{month}月的Career（职业工作）类别事件进行优化整理：

## 分析要求
1. **事件发展与变化分析**：从职业工作的角度，分析这个人一个月的职业事件如何发展，个人发生了什么样的变化
2. **类别体现与合理性评估**：评估职业工作角度是否有很好的体现出来，目前这个角度看事件是否合理，是否需要新增该类别的事件来展现该类别个人的一个月生活
3. **事件补充建议**：考虑如何新增该类别的事件来展现该类别个人的一个月生活
4. **事件丰富性与发展合理性分析**：分析现在在这个类别，事件是否丰富，体现出来的一个月的发展是否合理
5. 如果原事件中没有足够的事件展现这一个月的工作，请你进行补充这一个月的工作事件。

## 优化要求
1. **事件补充与多样性提升**：补充必要的职业事件以保障职业发展的多样性和真实性，体现个人在职业工作方面的全面发展。新增事件可以基于原事件，也可以完全独立添加，与其他事件无关，还可以考虑该类别发生在他人身上但与自己相关的事件。**注意：新增事件总数不应超过6个，且应尽量避免与已有事件重复相似，新增事件不要与已有事件冲突或导致已有事件不合理**。
2. **不合理事件处理**：对于不合理的事件选择调整
3. **事件质量优化**：提升事件描述的质量，使其更加具体、生动，突出职业发展的意义和价值
4. **事件关联性增强**：加强职业事件之间的关联关系，体现职业发展的连贯性和逻辑性（此要求仅适用于可关联的事件，独立新增的事件无需遵循此要求）

## 输出格式要求
请严格按照以下JSON格式输出优化后的操作结果、月度总结和修改原因：

**特别说明：** 若已有事件已合理多样，或该人物无类别相关事件（如学生不会有工作，工人不会有学习，穷人不会有资产），可以输出空的operations数组。
{{
  "month": "{month}",
  "category": "Career",
  "operations": [
    {{
      "action": "add",
      "event": {{
        "name": "事件名称，需简洁明了，与描述内容相关",
        "description": "完整的事件描述，需包含事件地点、参与人员、具体内容、事件目的等关键信息",
        "date": ["事件发生的日期范围，格式：YYYY-MM-DD至YYYY-MM-DD"],
        "type": "Career"
      }}
    }},
    {{
      "action": "rewrite",
      "original_event": {{
        "name": "原始事件名称"
      }},
      "new_event": {{
        "name": "修改后的事件名称",
        "description": "修改后的事件描述",
        "date": ["事件发生的日期范围"],
        "type": "Career"
      }}
    }}
  ],
  "monthly_summary": "从职业工作角度出发，串联所有事件，总结该人物一个月的职业生活描述。请使用流畅的语言将事件按时间顺序或逻辑关系串联起来，形成完整的月度职业发展画像。",
  "modification_reasons": [
    "针对每项操作（add/rewrite），说明具体的修改原因。请清晰列出每项修改的理由，解释为什么进行该修改以及预期达到的效果。"
  ]
}}
严格遵循JSON格式规范，在JSON字符串值中避免使用双引号，如果需要表示引号，请使用[]或其他替代符号，或者使用转义字符\\"，只输出JSON对象，不要输出任何额外的文本或注释。以{{}}开头。

## 输入数据
### 1. 人物在{month}月的Career类别事件
{original_events}

### 2. 该类别事件参考
以下是Career类别的事件参考信息，包含该类别下的阶段事件、原子事件和可感知/可复用行为：
{category_reference}

### 3. 人物画像
{profile_data}

## 类别定义
Career：职业工作相关，包括职业发展、工作内容、项目参与、行业活动、技能提升、职业关系、工作成果、职业挑战、工作环境、职业规划等与职业发展和工作相关的各类事件。
'''

template_education_optimization = '''
请基于以下信息对{month}月的Education（教育学习）类别事件进行优化整理，注意如果画像不是学生，则新增事件不得超过一个，尽量不做修改：

## 分析要求
1. **事件发展与变化分析**：从教育学习的角度，分析这个人一个月的学习事件如何发展，个人发生了什么样的变化
2. **类别体现与合理性评估**：评估教育学习角度是否有很好的体现出来，是否一成不变，目前这个角度看事件是否合理
3. **事件补充建议**：考虑如何新增该类别的事件来展现该类别个人的一个月生活
4. **事件丰富性与发展合理性分析**：分析现在在这个类别，事件是否丰富，体现出来的一个月的发展变化是否合理

## 优化要求
1. **事件补充与多样性提升**：补充必要的学习事件以保障教育学习的多样性和真实性，体现个人在教育学习方面的全面发展。新增事件可以基于原事件，也可以完全独立添加，与其他事件无关，还可以考虑该类别发生在他人身上但与自己相关的事件。**注意：所有操作（add/rewrite）总数不应超过5个，且应尽量避免与已有事件重复相似，新增事件不要与已有事件冲突或导致已有事件不合理**。
2. **不合理事件处理**：对于不合理的事件选择调整
3. **事件质量优化**：提升事件描述的质量，使其更加具体、生动，突出学习内容和成果
4. **事件关联性增强**：加强学习事件之间的关联关系，体现学习的连贯性和递进性（此要求仅适用于可关联的事件，独立新增的事件无需遵循此要求）

## 输出格式要求
请严格按照以下JSON格式输出优化后的操作结果、月度总结和修改原因：

**特别说明：** 若已有事件已合理多样，或该人物无类别相关事件（如学生不会有工作，工人不会有学习，穷人不会有资产），可以输出空的operations数组。
{{
  "month": "{month}",
  "category": "Education",
  "operations": [
    {{
      "action": "add",
      "event": {{
        "name": "事件名称，需简洁明了，与描述内容相关",
        "description": "完整的事件描述，需包含事件地点、参与人员、具体内容、事件目的等关键信息",
        "date": ["事件发生的日期范围，格式：YYYY-MM-DD至YYYY-MM-DD"],
        "type": "Education"
      }}
    }},
    {{
      "action": "rewrite",
      "original_event": {{
        "name": "原始事件名称"
      }},
      "new_event": {{
        "name": "修改后的事件名称",
        "description": "修改后的事件描述",
        "date": ["事件发生的日期范围"],
        "type": "Education"
      }}
    }}
  ],
  "monthly_summary": "从教育学习角度出发，串联所有事件，总结该人物一个月的学习生活描述。请使用流畅的语言将事件按时间顺序或逻辑关系串联起来，形成完整的月度学习发展画像。",
  "modification_reasons": [
    "针对每项操作（add/rewrite），说明具体的修改原因。请清晰列出每项修改的理由，解释为什么进行该修改以及预期达到的效果。"
  ]
}}
严格遵循JSON格式规范，在JSON字符串值中避免使用双引号，如果需要表示引号，请使用[]或其他替代符号，或者使用转义字符\\"，只输出JSON对象，不要输出任何额外的文本或注释。以{{}}开头。

## 输入数据
### 1. 人物在{month}月的Education类别事件
{original_events}

### 2. 该类别事件参考
以下是Education类别的事件参考信息，包含该类别下的阶段事件、原子事件和可感知/可复用行为：
{category_reference}

### 3. 人物画像
{profile_data}

## 类别定义
Education：教育学习相关，包括课程学习、考试认证、技能培训、知识拓展、学术交流、学习成果、学习计划、学习环境、学习习惯、终身学习等与教育和学习相关的各类事件。
'''

template_relationships_optimization = '''
请基于以下信息对{month}月的Relationships（人际关系）类别事件进行优化整理：

## 分析要求
1. **事件发展与变化分析**：从人际关系的角度，分析这个人一个月的生活事件如何发展，个人发生了什么样的变化
2. **类别体现与合理性评估**：评估人际关系角度是否有很好的体现出来，是否一成不变，目前这个角度看事件是否合理
3. **事件补充建议**：考虑如何新增该类别的事件来展现该类别个人的一个月生活
4. **事件丰富性与发展合理性分析**：分析现在在这个类别，事件是否丰富，体现出来的一个月的发展变化是否合理

## 优化要求
1. **事件补充与多样性提升**：补充必要的人际关系事件以保障人际关系发展的多样性和真实性，体现个人在社交互动方面的全面发展。新增事件可以基于原事件，也可以完全独立添加，与其他事件无关，还可以考虑该类别发生在他人身上但与自己相关的事件。**注意：所有操作（add/rewrite）总数不应超过5个，且应尽量避免与已有事件重复相似，新增事件不要与已有事件冲突或导致已有事件不合理**。
2. **不合理事件处理**：对于不合理的事件选择调整
3. **事件质量优化**：提升事件描述的质量，使其更加具体、生动，突出人际关系的发展和变化
4. **事件关联性增强**：加强人际关系事件之间的关联关系，体现人际关系网络的连贯性和整体性（此要求仅适用于可关联的事件，独立新增的事件无需遵循此要求）

## 输出格式要求
请严格按照以下JSON格式输出优化后的操作结果、月度总结和修改原因：

**特别说明：** 若已有事件已合理多样，或该人物无类别相关事件（如学生不会有工作，工人不会有学习，穷人不会有资产），可以输出空的operations数组。
{{
  "month": "{month}",
  "category": "Relationships",
  "operations": [
    {{
      "action": "add",
      "event": {{
        "name": "事件名称，需简洁明了，与描述内容相关",
        "description": "完整的事件描述，需包含事件地点、参与人员、具体内容、事件目的等关键信息",
        "date": ["事件发生的日期范围，格式：YYYY-MM-DD至YYYY-MM-DD"],
        "type": "Relationships"
      }}
    }},
    {{
      "action": "rewrite",
      "original_event": {{
        "name": "原始事件名称"
      }},
      "new_event": {{
        "name": "修改后的事件名称",
        "description": "修改后的事件描述",
        "date": ["事件发生的日期范围"],
        "type": "Relationships"
      }}
    }}
  ],
  "monthly_summary": "从人际关系角度出发，串联所有事件，总结该人物一个月的社交生活描述。请使用流畅的语言将事件按时间顺序或逻辑关系串联起来，形成完整的月度人际关系画像。",
  "modification_reasons": [
    "针对每项操作（add/rewrite），说明具体的修改原因。请清晰列出每项修改的理由，解释为什么进行该修改以及预期达到的效果。"
  ]
}}
严格遵循JSON格式规范，在JSON字符串值中避免使用双引号，如果需要表示引号，请使用[]或其他替代符号，或者使用转义字符\\"，只输出JSON对象，不要输出任何额外的文本或注释。以{{}}开头。

## 输入数据
### 1. 人物在{month}月的Relationships类别事件
{original_events}

### 2. 该类别事件参考
以下是Relationships类别的事件参考信息，包含该类别下的阶段事件、原子事件和可感知/可复用行为：
{category_reference}

### 3. 人物画像
{profile_data}

## 类别定义
Relationships：人际关系相关，包括亲情、友情、爱情、社交活动、人际互动、情感交流、社交网络、沟通方式、关系维护、情感支持、人际冲突、关系发展、社会融入、亲密关系、家庭关系、朋友关系、同事关系、社交技能、情感表达等与人际关系发展和维护相关的各类事件。
'''

template_family_living_optimization = '''
请基于以下信息对{month}月的Family&Living Situation（家庭生活与居住环境）类别事件进行优化整理：

## 分析要求
1. **事件发展与变化分析**：从家庭生活与居住环境的角度，分析这个人一个月的家庭生活事件如何发展，个人发生了什么样的变化
2. **类别体现与合理性评估**：评估家庭生活与居住环境角度是否有很好的体现出来，是否一成不变，目前这个角度看事件是否合理
3. **事件补充建议**：考虑如何新增该类别的事件来展现该类别个人的一个月生活
4. **事件丰富性与发展合理性分析**：分析现在在这个类别，事件是否丰富，体现出来的一个月的发展变化是否合理

## 优化要求
1. **事件补充与多样性提升**：补充必要的家庭生活事件以保障家庭生活与居住环境的多样性和真实性，体现个人在家庭生活方面的全面发展。新增事件可以基于原事件，也可以完全独立添加，与其他事件无关，还可以考虑该类别发生在他人身上但与自己相关的事件。**注意：所有操作（add/rewrite）总数不应超过5个，且应尽量避免与已有事件重复相似，新增事件不要与已有事件冲突或导致已有事件不合理**。
2. **不合理事件处理**：对于不合理的事件选择调整
3. **事件质量优化**：提升事件描述的质量，使其更加具体、生动，突出家庭生活与居住环境的变化和发展
4. **事件关联性增强**：加强家庭生活事件之间的关联关系，体现家庭生活的连贯性和整体性（此要求仅适用于可关联的事件，独立新增的事件无需遵循此要求）

## 输出格式要求
请严格按照以下JSON格式输出优化后的操作结果、月度总结和修改原因：

**特别说明：** 若已有事件已合理多样，或该人物无类别相关事件（如学生不会有工作，工人不会有学习，穷人不会有资产），可以输出空的operations数组。
{{
  "month": "{month}",
  "category": "Family&Living Situation",
  "operations": [
    {{
      "action": "add",
      "event": {{
        "name": "事件名称，需简洁明了，与描述内容相关",
        "description": "完整的事件描述，需包含事件地点、参与人员、具体内容、事件目的等关键信息",
        "date": ["事件发生的日期范围，格式：YYYY-MM-DD至YYYY-MM-DD"],
        "type": "Family&Living Situation"
      }}
    }},
    {{
      "action": "rewrite",
      "original_event": {{
        "name": "原始事件名称"
      }},
      "new_event": {{
        "name": "修改后的事件名称",
        "description": "修改后的事件描述",
        "date": ["事件发生的日期范围"],
        "type": "Family&Living Situation"
      }}
    }}
  ],
  "monthly_summary": "从家庭生活与居住环境角度出发，串联所有事件，总结该人物一个月的家庭生活描述。请使用流畅的语言将事件按时间顺序或逻辑关系串联起来，形成完整的月度家庭生活与居住环境画像。",
  "modification_reasons": [
    "针对每项操作（add/rewrite），说明具体的修改原因。请清晰列出每项修改的理由，解释为什么进行该修改以及预期达到的效果。"
  ]
}}
严格遵循JSON格式规范，在JSON字符串值中避免使用双引号，如果需要表示引号，请使用[]或其他替代符号，或者使用转义字符\\"，只输出JSON对象，不要输出任何额外的文本或注释。以{{}}开头。

## 输入数据
### 1. 人物在{month}月的Family&Living Situation类别事件
{original_events}

### 2. 该类别事件参考
以下是Family&Living Situation类别的事件参考信息，包含该类别下的阶段事件、原子事件和可感知/可复用行为：
{category_reference}

### 3. 人物画像
{profile_data}

## 类别定义
Family&Living Situation：家庭生活与居住环境相关，包括家庭日常、居住环境、家居布置、家庭活动、生活设施、家庭责任、家庭氛围、居住体验、生活习惯、家庭事务、家庭关系等与家庭生活和居住环境相关的各类事件。
'''

template_personal_life_optimization = '''
请基于以下信息对{month}月的Personal Life（个人生活）类别事件进行优化整理：

## 分析要求
1. **事件发展与变化分析**：从个人生活的角度，分析这个人一个月的生活事件如何发展，个人发生了什么样的变化
2. **类别体现与合理性评估**：评估个人生活角度（爱好，偏好，休闲娱乐）是否有很好的体现出来，是否一成不变，目前这个角度看事件是否合理
3. **事件补充建议**：考虑如何新增该类别的事件来展现该类别个人的一个月生活
4. **事件丰富性与发展合理性分析**：分析现在在这个类别，事件是否丰富，体现出来的一个月的发展变化是否合理
5. 如果原事件中没有足够的事件展现这一个月的个人生活，包括生活，娱乐，个人兴趣，休闲，请你进行补充这一个月的个人事件。
## 优化要求
1. **事件补充与多样性提升**：补充必要的个人生活事件以保障个人生活的多样性和真实性，体现个人在自我关怀和生活方式方面的全面发展。新增事件可以基于原事件，也可以完全独立添加，与其他事件无关，还可以考虑该类别发生在他人身上但与自己相关的事件。**注意：所有操作（add/rewrite）总数不应超过5个，且应尽量避免与已有事件重复相似，新增事件不要与已有事件冲突或导致已有事件不合理**。
2. **不合理事件处理**：对于不合理的事件选择调整
3. **事件质量优化**：提升事件描述的质量，使其更加具体、生动，突出个人生活的丰富性和幸福感
4. **事件关联性增强**：加强个人生活事件之间的关联关系，体现个人生活方式的连贯性和整体性（此要求仅适用于可关联的事件，独立新增的事件无需遵循此要求）

## 输出格式要求
请严格按照以下JSON格式输出优化后的操作结果、月度总结和修改原因：

**特别说明：** 若已有事件已合理多样，或该人物无类别相关事件（如学生不会有工作，工人不会有学习，穷人不会有资产），可以输出空的operations数组。
{{
  "month": "{month}",
  "category": "Personal Life",
  "operations": [
    {{
      "action": "add",
      "event": {{
        "name": "事件名称，需简洁明了，与描述内容相关",
        "description": "完整的事件描述，需包含事件地点、参与人员、具体内容、事件目的等关键信息",
        "date": ["事件发生的日期范围，格式：YYYY-MM-DD至YYYY-MM-DD"],
        "type": "Personal Life"
      }}
    }},
    {{
      "action": "rewrite",
      "original_event": {{
        "name": "原始事件名称"
      }},
      "new_event": {{
        "name": "修改后的事件名称",
        "description": "修改后的事件描述",
        "date": ["事件发生的日期范围"],
        "type": "Personal Life"
      }}
    }}
  ],
  "monthly_summary": "从自我关怀、娱乐与生活方式角度出发，串联所有事件，总结该人物一个月的个人生活描述。请使用流畅的语言将事件按时间顺序或逻辑关系串联起来，形成完整的月度个人生活画像。",
  "modification_reasons": [
    "针对每项操作（add/rewrite），说明具体的修改原因。请清晰列出每项修改的理由，解释为什么进行该修改以及预期达到的效果。"
  ]
}}
严格遵循JSON格式规范，在JSON字符串值中避免使用双引号，如果需要表示引号，请使用[]或其他替代符号，或者使用转义字符\\"，只输出JSON对象，不要输出任何额外的文本或注释。以{{}}开头。

## 输入数据
### 1. 人物在{month}月的Personal Life类别事件
{original_events}

### 2. 该类别事件参考
以下是Personal Life类别的事件参考信息，包含该类别下的阶段事件、原子事件和可感知/可复用行为：
{category_reference}

### 3. 人物画像
{profile_data}

## 类别定义
Personal Life：自我关怀、娱乐与生活方式相关，包括休闲娱乐、自我提升、兴趣爱好、社交活动、身心健康、生活品质、个人成长、情感体验、生活习惯、个人规划等与个人生活质量和幸福感相关的各类事件。
'''

template_finance_optimization = '''
请基于以下信息对{month}月的Finance（个人资产财务）类别事件进行优化整理：

## 分析要求
1. **事件发展与变化分析**：从个人资产财务的角度，分析这个人一个月的财务事件如何发展，个人发生了什么样的变化
2. **类别体现与合理性评估**：评估个人资产财务角度是否有很好的体现出来，是否一成不变，目前这个角度看事件是否合理
3. **事件补充建议**：考虑如何新增该类别的事件来展现该类别个人的一个月生活
4. **事件丰富性与发展合理性分析**：分析现在在这个类别，事件是否丰富，体现出来的一个月的发展变化是否合理

## 优化要求
1. **事件补充与多样性提升**：补充必要的财务事件以保障个人资产财务的多样性和真实性，体现个人在财务状况和管理方面的全面发展。新增事件可以基于原事件，也可以完全独立添加，与其他事件无关，还可以考虑该类别发生在他人身上但与自己相关的事件。**注意：所有操作（add/rewrite）总数不应超过5个，且应尽量避免与已有事件重复相似，新增事件不要与已有事件冲突或导致已有事件不合理**。
2. **不合理事件处理**：对于不合理的事件选择调整
3. **事件质量优化**：提升事件描述的质量，使其更加具体、生动，突出财务状况的变化和管理效果
4. **事件关联性增强**：加强财务事件之间的关联关系，体现财务规划的连贯性和资产管理的整体性（此要求仅适用于可关联的事件，独立新增的事件无需遵循此要求）

## 输出格式要求
请严格按照以下JSON格式输出优化后的操作结果、月度总结和修改原因：

**特别说明：** 若已有事件已合理多样，或该人物无类别相关事件（如学生不会有工作，工人不会有学习，穷人不会有资产），可以输出空的operations数组。
{{
  "month": "{month}",
  "category": "Finance",
  "operations": [
    {{
      "action": "add",
      "event": {{
        "name": "事件名称，需简洁明了，与描述内容相关",
        "description": "完整的事件描述，需包含事件地点、参与人员、具体内容、事件目的等关键信息",
        "date": ["事件发生的日期范围，格式：YYYY-MM-DD至YYYY-MM-DD"],
        "type": "Finance"
      }}
    }},
    {{
      "action": "rewrite",
      "original_event": {{
        "name": "原始事件名称"
      }},
      "new_event": {{
        "name": "修改后的事件名称",
        "description": "修改后的事件描述",
        "date": ["事件发生的日期范围"],
        "type": "Finance"
      }}
    }}
  ],
  "monthly_summary": "从个人资产财务角度出发，串联所有事件，总结该人物一个月的财务状况描述。请使用流畅的语言将事件按时间顺序或逻辑关系串联起来，形成完整的月度财务状况画像。",
  "modification_reasons": [
    "针对每项操作（add/rewrite），说明具体的修改原因。请清晰列出每项修改的理由，解释为什么进行该修改以及预期达到的效果。"
  ]
}}
严格遵循JSON格式规范，在JSON字符串值中避免使用双引号，如果需要表示引号，请使用[]或其他替代符号，或者使用转义字符\\"，只输出JSON对象，不要输出任何额外的文本或注释。以{{}}开头。

## 输入数据
### 事件
人物在{month}月的Finance类别事件：
{original_events}

### 事件参考
以下是Finance类别的事件参考信息，包含该类别下的阶段事件、原子事件和可感知/可复用行为：
{category_reference}

### 人物画像
{profile_data}

## 类别定义
Finance：个人资产财务相关，包括收入来源、支出管理、投资理财、资产配置、消费习惯、财务规划、债务管理、保险保障、税务规划、财务目标等与个人财务状况和管理相关的各类事件。
'''

template_health_optimization = '''
请基于以下信息对{month}月的Health（健康管理）类别事件进行优化整理：

## 分析要求
1. **事件发展与变化分析**：从运动健康的角度，分析这个人一个月的生活事件如何发展，个人发生了什么样的变化
2. **类别体现与合理性评估**：评估运动健康角度是否有很好的体现出来，是否一成不变，目前这个角度看事件是否合理
3. **事件补充建议**：考虑如何新增该类别的事件来展现该类别个人的一个月生活
4. **事件丰富性与发展合理性分析**：分析现在在这个类别，事件是否丰富，体现出来的一个月的发展变化是否合理

## 优化要求
1. **事件补充与多样性提升**：补充必要的健康事件以保障健康管理的多样性和真实性，体现个人在运动健康方面的全面发展。新增事件可以基于原事件，也可以完全独立添加，与其他事件无关，还可以考虑该类别发生在他人身上但与自己相关的事件。**注意：所有操作（add/rewrite）总数不应超过5个，且应尽量避免与已有事件重复相似，新增事件不要与已有事件冲突或导致已有事件不合理**。
2. **不合理事件处理**：对于不合理的事件选择调整
3. **事件质量优化**：提升事件描述的质量，使其更加具体、生动，突出健康状况的变化和发展
4. **事件关联性增强**：加强健康事件之间的关联关系，体现健康管理的连贯性和发展变化（此要求仅适用于可关联的事件，独立新增的事件无需遵循此要求）
**特别说明：** 若已有事件已合理多样，或该人物无类别相关事件（如学生不会有工作，工人不会有学习，穷人不会有资产），可以输出空的operations数组。

## 输出格式要求
请严格按照以下JSON格式输出优化后的操作结果、月度总结和修改原因：
{{
  "month": "{month}",
  "category": "Health",
  "operations": [
    {{    
      "action": "add",
      "event": {{
        "name": "事件名称，需简洁明了，与描述内容相关",
        "description": "完整的事件描述，需包含事件地点、参与人员、具体内容、事件目的等关键信息",
        "date": ["事件发生的日期范围，格式：YYYY-MM-DD至YYYY-MM-DD"],
        "type": "Health"
      }}
    }},
    {{
      "action": "rewrite",
      "original_event": {{
        "name": "原始事件名称"
      }},
      "new_event": {{
        "name": "修改后的事件名称",
        "description": "修改后的事件描述",
        "date": ["事件发生的日期范围"],
        "type": "Health"
      }}
    }}
  ],
  "monthly_summary": "从运动健康角度出发，串联所有事件，总结该人物一个月的生活描述。请使用流畅的语言将事件按时间顺序或逻辑关系串联起来，形成完整的月度生活画像。",
  "modification_reasons": [
    "针对每项操作（add/rewrite），说明具体的修改原因。请清晰列出每项修改的理由，解释为什么进行该修改以及预期达到的效果。"
  ]
}}
严格遵循JSON格式规范，在JSON字符串值中避免使用双引号，如果需要表示引号，请使用[]或其他替代符号，或者使用转义字符\\"，只输出JSON对象，不要输出任何额外的文本或注释。以{{}}开头。
---

## 输入数据
### 1. 人物在{month}月的Health类别事件
{original_events}

### 2. 该类别事件参考
以下是Health类别的事件参考信息，包含该类别下的阶段事件、原子事件和可感知/可复用行为：
{category_reference}

### 3. 人物画像
{profile_data}

## 类别定义
Health：运动与健康，包括运动锻炼、健康饮食、养生、地点活动、运动能力表现、训练里程碑事件、 生理健康类事件、行为习惯类事件（运动健康相关的习惯，偏好，生活方式的改变）、 比赛赛事类事件、训练计划类事件、空间探索类事件等、社交互动类事件、环境适应类事件、 恢复能力类事件、禁忌发现类事件、趋势演化类事件。
'''

template_impact_events_analysis = '''
请基于以下人物画像、初始健康状态和指定时间段内的事件列表，分析并生成该月15号中间状态、结束时的健康状态记录和完整变化节点：

## 人物画像
{persona}

## 初始健康状态
{initial_health_state}

## 输入数据
{daily_data}

## 分析要求
请系统分析上述数据，结合客观环境变化（如四季更替、气候转换）、社会常理变化（如法定节假日、周末休息、工作周期）以及事件影响，完成以下任务：

1. **深度分析输入数据的变化**：仔细挖掘每日数据中的趋势和变化，特别是关于运动、睡眠、饮食、健康状态等方面的信息

2. **合理新增变化事件**：基于人物画像和生活常理，补充至少3-5个未在输入数据中明确提及但符合逻辑的变化事件，例如：
   - 临时工作压力导致的作息变化
   - 天气变化对运动方式的影响
   - 社交活动导致的饮食或睡眠波动
   - 健康意识提升引发的习惯调整
   - 小伤病或不适导致的运动暂停

3. **生成15号中间状态**：生成该月15号的健康状态记录，与初始状态和最终状态形成连贯的变化过程，例如：
   - 运动类型开始出现变化但尚未完全成型
   - 睡眠时间已经开始调整但尚未稳定
   - 体重有初步波动但未达到最终变化
   - 开始尝试新的健康习惯但尚未形成固定模式
   - 运动能力或表现有初步变化

4. **生成多样性的最终状态**：确保一个月结束时的健康状态与初始状态和中间状态有明显差异且合理多样，避免同质，例如：
   - 运动类型从单一变为多样化
   - 睡眠时间从不规律变为更规律（或反之，基于事件影响）
   - 体重有合理的波动和最终变化
   - 新增或调整了健康习惯
   - 运动能力或表现有提升或下降

5. **记录完整变化过程**：在change_nodes中详细记录所有变化，包括：
   - 基于输入数据的真实变化
   - 合理新增的变化事件
   - 变化过程中的波动性（如体重先升后降，睡眠质量时好时坏）
   - 每次变化的触发因素、前后状态、持续时间和影响

6. **重点关注波动数据**：对睡眠时间、体重、运动频率等可量化指标，展现其在一个月内的波动性，特别是初始状态到15号中间状态，再到最终状态的变化过程，例如：
   - 体重记录：初始70kg → 因聚会增加至71.5kg（15号）→ 因调整饮食下降至69.5kg
   - 睡眠时间：初始23:30-07:30 → 因项目加班变为00:30-08:00（15号）→ 周末补觉变为22:30-09:00 → 最终调整为23:00-07:00
   - 运动频率：初始每周3次 → 因天气原因减少至每周1次（15号）→ 加入健身群后增加至每周5次

### 分析原则
- **系统性**：覆盖健康生活的各个关键维度，确保分析全面
- **连贯性**：变化节点按时间顺序排列，体现状态的逐步演变
- **客观性**：结合客观环境和常理解释变化原因
- **合理性**：所有新增变化必须符合人物画像和生活逻辑
- **多样性**：最终状态与初始状态有明显差异，体现丰富的生活变化
- **波动性**：展现健康数据在变化过程中的起伏，避免线性单调变化
- **完整性**：记录所有重要变化，包括临时波动和长期趋势

## 输出格式要求
请严格遵循以下JSON格式输出分析结果：
- mid_month_state：该月15号的健康状态记录，采用指定的JSON格式
- end_of_month_state：一个月结束时的健康状态记录，采用指定的JSON格式
- change_nodes：一个数组，按时间顺序记录该月内的所有变化节点

### 状态记录格式
必须使用以下格式记录健康状态：
{{
  "mid_month_state": {{
    "exercise_events": [
      {{
        "name": "运动名称",
        "description": "运动描述",
        "location_preference": "地点偏好",
        "method_preference": "方式偏好"
      }}
    ],
    "sleep_time": {{
      "bedtime": "HH:MM至HH:MM",
      "wakeup": "HH:MM至HH:MM"
    }},
    "weight_record": "体重值（如：71kg）",
    "performance": "能力表现描述（如：5公里跑步时间从25分钟变为24.5分钟）",
    "health_status": {{
      "summary": "整体健康状态总结",
      "injury_records": [
        {{
          "injury_name": "伤病名称",
          "date": "发生日期（如：2023-01-15）",
          "description": "伤病描述"
        }}
      ]
    }},
    "habits_summary": {{
      "lifestyle_summary": "个人一天的生活模式总结，包括大概会干什么，怎么安排，什么时间做什么事",
      "fixed_habits": [
        "固定习惯1（如：每天早上7:30喝一杯温水）",
        "固定习惯2（如：尝试每周一三五晚上进行运动）"
      ]
    }},
    "preferences_summary": {{
      "preferences": "运动、饮食等方面的偏好（如：开始尝试户外跑步）",
      "taboos": "运动、饮食等方面的禁忌（如：避免睡前3小时剧烈运动）"
    }},
    "training_plan": [
      {{
        "plan": "计划名称（如：初步减脂计划）",
        "date": "YYYY-MM-DD(制定时间)",
        "status": "到目前为止的完成情况（如：已开始实施，体重略有上升）",
        "description": "计划完整描述"
      }}
    ],
    "exercise_social_interactions": ["社交互动1（如：考虑加入公司跑步群）", "社交互动2（如：与朋友讨论羽毛球运动）"]
  }},
  "end_of_month_state": {{
    "exercise_events": [
      {{
        "name": "运动名称",
        "description": "运动描述",
        "location_preference": "地点偏好",
        "method_preference": "方式偏好"
      }}
    ],
    "sleep_time": {{
      "bedtime": "HH:MM至HH:MM",
      "wakeup": "HH:MM至HH:MM"
    }},
    "weight_record": "体重值（如：69.5kg）",
    "performance": "能力表现描述（如：5公里跑步时间从25分钟提升至23分钟）",
    "health_status": {{
      "summary": "整体健康状态总结",
      "injury_records": [
        {{
          "injury_name": "伤病名称",
          "date": "发生日期（如：2023-01-15）",
          "description": "伤病描述"
        }}
      ]
    }},
    "habits_summary": {{
      "lifestyle_summary": "个人一天的生活模式总结，包括大概会干什么，怎么安排，什么时间做什么事",
      "fixed_habits": [
        "固定习惯1（如：每天早上7:30喝一杯温水）",
        "固定习惯2（如：每周一三五晚上进行运动）"
      ]
    }},
    "preferences_summary": {{
      "preferences": "运动、饮食等方面的偏好（如：偏好户外跑步而非室内健身）",
      "taboos": "运动、饮食等方面的禁忌（如：避免睡前3小时剧烈运动）"
    }},
    "training_plan": [
      {{
        "plan": "计划名称（如：春季减脂计划）",
        "date": "YYYY-MM-DD(制定时间)",
        "status": "到目前为止的完成情况（如：已完成70%，体重下降2kg）",
        "description": "计划完整描述"
      }}
    ],
    "exercise_social_interactions": ["社交互动1（如：加入公司跑步群）", "社交互动2（如：与朋友每周进行一次羽毛球运动）"]
  }},
  "change_nodes": [
    {{
      "trigger": "变化触发因素（如：2023-01-05开始新项目，工作压力增大）",
      "before_change": "变化前状态（如：体重70kg，每天23:30前入睡）",
      "after_change": "变化后状态（如：体重逐渐上升至71kg，经常24:00后入睡）",
      "duration": "变化持续时间（如：2023-01-05至2023-01-15）",
      "impact": "对健康生活的影响（如：白天精神状态不佳，运动频率减少）"
    }},
    {{
      "trigger": "变化触发因素（如：2023-01-16天气转暖，适合户外运动）",
      "before_change": "变化前状态（如：主要在健身房进行力量训练）",
      "after_change": "变化后状态（如：每周增加2次户外跑步）",
      "duration": "变化持续时间（如：2023-01-16至今）",
      "impact": "对健康生活的影响（如：心肺功能提升，心情更加愉悦）"
    }},
    {{
      "trigger": "变化触发因素（如：2023-01-20朋友聚会，饮食不规律）",
      "before_change": "变化前状态（如：体重70.5kg，保持健康饮食）",
      "after_change": "变化后状态（如：体重短暂上升至71.2kg，连续2天饮食油腻）",
      "duration": "变化持续时间（如：2023-01-20至2023-01-21）",
      "impact": "对健康生活的影响（如：肠胃不适，运动表现下降）"
    }},
    {{
      "trigger": "变化触发因素（如：2023-01-22开始实施减脂计划）",
      "before_change": "变化前状态（如：体重71kg，运动频率每周3次）",
      "after_change": "变化后状态（如：体重逐渐下降至69.5kg，运动频率增加至每周5次）",
      "duration": "变化持续时间（如：2023-01-22至今）",
      "impact": "对健康生活的影响（如：身体更加轻盈，运动能力提升）"
    }}
  ]
}}

## 输出要求
1. 确保change_nodes至少包含8-10个变化节点，既有基于输入数据的变化，也有合理新增的变化
2. 展现数据的波动性，避免线性单调变化
3. 最终状态与初始状态有明显差异且合理
4. 所有变化必须符合人物画像和生活常理
5. 严格遵循指定的JSON格式，确保所有字段完整
'''

template_important_nodes = '''
请基于以下人物画像数据，提取该人物在今年（2025年）可能发生的重要节点或里程碑事件。

## 一、重要节点定义
重要节点是指对人物生活、职业、家庭或社交有重大影响变动的事件，或里程碑事件，可能是积极或消极的包括但不限于：
- 个人发展：升学、升职、换工作、创业、考取证书、职业培训、职业转型、重要项目完成等
- 家庭生活：结婚、生育、搬家、装修、买房、买车、家庭聚会、子女教育关键阶段、家庭成员健康变化等
- 社交关系：重要朋友/同事的婚礼、生日、升职、搬家、健康问题、职业变动、重要成就等
- 健康：重要体检、手术、康复、健身目标达成、疾病诊断、健康危机、健康习惯重大改变等
- 财务：重大投资、理财、债务偿还、大额消费、财务危机、意外收入、资产变动等
- 其他：旅行、重要会议、展览、演出、意外事件、法律事务、社会活动等

## 二、思考思路
请从以下两个思路出发进行事件提取：
1. **基于推理**：根据人物画像进行逻辑推理，分析这一年可能发生的变化与事件。例如：
   - 学生角色：可能会有考试、寒暑假、论文答辩等
   - 职场人士：可能会有重要项目、职业晋升、工作调整等
   - 个人生活：可能会经历搬家、结婚、生育、健康变化等人生阶段变动
   - 基于现有画像信息，推理人物可能面临的关键事件

2. **基于生成**：为人物生成一些画像中推理不出，但符合其身份和特征的可能重要事件，或许多人类都可能进行的事件。例如：
   旅行、重要会议、展览、演出、意外事件、法律事务、社会活动等

## 三、提取要求
2. **事件影响多样性**：每个重要节点需明确标注其影响性质（积极/消极/中性），并描述其可能的短期和长期影响，注意消极影响事件不要超过35%。
3. **非线性发展**：事件发展可能具有非线性特征，需考虑可能的转折点、意外变化、连锁反应等复杂情况。
4. **详细描述**：每个重要节点需包含明确的事件内容、参与者（如果涉及他人）、事件意义和背景信息，并明确说明主要发展轨迹。
5. **类别标注**：
   - 关于人物本人的事件，或直接影响到人物本人的事件：分配到对应的类别（Career、Education、Relationships、Family&Living Situation、Personal Life、Finance、Health、Other）
   - 关于其他社交关系人士且对人物本人影响不大的事件：统一分配到 Relationships 类别
   - **严格遵循类别要求**：必须且只能使用上述指定的类别（Career、Education、Relationships、Family&Living Situation、Personal Life、Finance、Health、Other），不得出现任何其他类别名称或文字。
   - 请确保每个重要节点准确标注类别。

## 六、输出格式要求
严格按照以下JSON格式输出，确保语法正确：
{{
  "personal_nodes": [
    {{
      "name": "事件名称",
      "date": "2025-XX-XX",
      "type": "类别",
      "description": "详细描述",
      "participant": ["参与者1", "参与者2"],
      "impact": "可能产生的影响，变化",
      "short_term_effect": "短期影响",
      "long_term_effect": "长期影响",
      "development_trajectory": "事件发展轨迹描述（可包含非线性变化）",
      ]
    }}
  ]
}}

---

人物画像：{persona}
'''

template_social_nodes = '''
请基于以下主要人物信息（不含社交关系）和社交关系组数据，提取2025年可能发生的与社交关系人物的重要节点或里程碑事件。

## 一、重要节点定义
重要节点是指对主要人物或其社交关系相关人士的生活、职业、家庭或社交有重大影响的事件，可能是积极或消极的，包括但不限于：
- 职业发展：升职、换工作、创业、考取证书、职业培训、职业转型、重要项目完成等
- 家庭生活：结婚、生育、搬家、装修、买房、买车、家庭聚会、子女教育关键阶段等
- 健康：重要体检、手术、康复、健身目标达成、疾病诊断等
- 财务：重大投资、理财、债务偿还、大额消费等
- 社交活动：多人聚会、集体旅行、共同项目、团队建设、重要庆典等
- 其他：旅行、重要会议、展览、演出、意外事件等

## 二、提取要求
1. 合理推理生成事件，分析可能发生的某个人或某个人社交圈的今年2025年可能发生的重要节点事件。
2. **支持单人/多人事件**：可以分析每个人物的单人的今年2025年可能发生的重要节点事件，也可以分析相关圈子的涉及多个社交关系人士的集体事件节点。
3. **事件影响分析**：需分析事件的影响，产生的变化，接下来可能的发展，并明确影响性质（积极/消极/中性）。
4. **关系明确**：需明确标注相关人士，多人事件需列出所有相关人士。
5. **详细描述**：每个重要节点需包含明确的事件内容、参与者、事件意义和背景信息。
6. **类别标注**：
   - 关于主要人物本人的事件，或直接影响到主要人物本人的事件：分配到对应的类别（Career、Education、Relationships、Family&Living Situation、Personal Life、Finance、Health、Other）
   - 关于其他社交关系人士且对主要人物本人影响不大的事件：统一分配到 Relationships 类别
   - **严格遵循类别要求**：必须且只能使用上述指定的类别（Career、Education、Relationships、Family&Living Situation、Personal Life、Finance、Health、Other），不得出现任何其他类别名称或文字。
   - 请确保每个重要节点准确标注类别。

## 三、输出格式要求
严格按照以下JSON格式输出，确保语法正确：
{{
  "social_nodes": [
    {{
      "name": "事件名称",
      "date": "2025-XX-XX",
      "type": "类别",
      "description": "详细描述",
      "related_persons": ["相关人士1姓名", "相关人士2姓名"],
      "relationships": ["与该人物的关系1", "与该人物的关系2"],
      "impact": "可能产生的影响，变动",
    }}
  ]
}}

---

主要人物信息（不含社交关系）：{main_persona}

当前处理的社交关系组：{social_group}
'''

template_event_timeline = '''
请基于以下人物画像和该人物在{event_type}类别的重要节点事件，为该人物生成2025年在{event_type}类别的主题时间线。

## 一、主题时间线要求
1. **主题构建**：从提供的重要节点事件中选择最合理、最符合人物画像的关键事件作为核心主题，构建连贯的时间线。每个主题聚焦一个核心概念，确保覆盖人物在该领域的主要生活维度。主题数目不超过三个。
2. **因果关联与发展脉络**：时间线需呈现同一主题下事件的紧密因果逻辑关系和完整发展过程，避免孤立事件堆砌。清晰展现事件的起源、发展、转折和结果。
3. **事件影响延伸**：重点体现事件的后续影响（如升职后的加薪调整、工作内容变动、家庭关系变化等），确保时间线反映事件的长期影响而非仅记录单一事件。
4. **前后事件补足**：基于核心事件，合理推导并补足必要的前置事件（如升职前的准备工作、项目积累）和后续重要事件，形成完整的事件链条。
5. **时间灵活性**：时间线不要求覆盖完整一年，允许从年中开始（如6月）或提前结束（如9月后无后续事件），中间也可存在事件空白期（如主题搁置、等待阶段）。
6. **主题演进性**：注意事件可能随时间发展演变为新的主题，需自然过渡并清晰标记主题变化的节点。
7. **个性化呈现**：深度结合人物画像，充分体现该人物的性格特点、职业背景、生活环境和社交关系网络，确保事件发展符合人物的行为逻辑。
8. **事件筛选**：优先选择重要事件或必然发生的事件进行扩展，对于难以融入事件线或不合理的事件可以忽略，以保证时间线的连贯性和合理性。
9. **时间线独立性**：生成的时间线之间应避免逻辑冲突，可通过筛选事件来确保各主题的合理性。
10. **事件转折与非线性发展**：为增加时间线的真实性和戏剧性，可适当引入事件的转折与波动，使事件发展呈现非线性特征。例如：
    - 先抑后扬：事件初期遇到困难或挫折，后来通过努力或机遇成功解决
    - 另辟蹊径：原定计划受阻，转而采取其他方法或途径实现目标
    - 种桃得李：原本追求某个目标，最终获得了意外的收获或成果
    - 峰回路转：事件发展出现意想不到的转折，改变了原有的方向或结果
    转折与发展的概率不宜过高，需符合人物画像和事件逻辑，避免强行添加不合理的转折。

## 二、思考引导（请仔细阅读并按步骤思考）
1. **画像与事件关联分析**：
   - 仔细阅读人物画像，识别与{event_type}类别强相关的所有信息点（如：家庭结构、居住情况、社交关系、生活习惯等）
   - 列出画像中与该类别相关的所有重要人物（如：家人、朋友、同事等）及其与主角的关系
   - 分析这些人物和信息点如何影响主角在该类别的行为和决策

2. **核心事件选择与整合**：
   - 从提供的重要节点事件中筛选出最符合人物画像、最具发展潜力的核心事件，或可以进行整合融入个人一年生活的事件
   - 有些事件可以整合入一个主题时间线
   - 识别这些核心事件之间的因果关系和时间顺序
   - 思考核心事件的前置条件和后续影响，确定需要补充的事件节点
   - 思考是否有信息缺口（如不能体现的画像，人物，关系信息）需要通过合理推理填补
    - 注意该个人或其他关系人物的重要节点里程碑事件要明确为一个时间线。
3. **时间线构建**：
   - 以核心事件为中心，构建包含前置准备、事件发生、后续影响的完整时间线
   - 确定时间线的起始和结束点，合理安排事件的时间分布
   - 处理事件空白期，明确说明主题搁置或等待的原因

4. **主题演进处理**：
   - 分析事件发展是否可能演变为新的主题
   - 若发生主题变化，需自然过渡并清晰定义新主题的核心内容
   - 确保主题变化符合人物的发展逻辑和行为模式

5. **事件转折与非线性发展分析**：
   - 分析核心事件是否存在可能的转折点或非线性发展路径
   - 思考是否有合理的机会引入事件的波动（如先抑后扬、另辟蹊径、种桃得李等）
   - 评估转折与人物画像的契合度，确保转折符合人物的性格和行为逻辑
   - 确定转折的时机和方式，使其自然融入时间线发展
   - 考虑转折对后续事件的影响，确保整体逻辑连贯

6. **合理性验证**：
   - 检查时间线是否符合人物画像设定
   - 验证事件之间的因果关系是否合理
   - 确保事件的后续影响符合逻辑预期
   - 评估引入的转折是否合理，避免过度戏剧性或不符合人物逻辑的转折

## 三、输出格式要求
请严格按照以下JSON数组格式输出结果，每个数组元素代表一个完整的主题时间线，不要使用任何注释、解释或markdown代码，其中"topic","detailed_description","month","content","impact"都为字符串形式，值需要"双引号包裹。

[
{{
  "topic": "主题名称",
  "detailed_description": "主题的核心内容和发展脉络的详细描述，包括月为粒度的主要事件和发展，要求语言流畅、逻辑连贯、内容丰富，突出因果关系和事件影响",
  "monthly_description": [
    {{
      "month": "1月",
      "content": "该月份发生的具体事件内容",
      "impact": "该月份事件产生的影响和意义，特别是对后续事件的推动作用",
      "core_events": ["核心事件1", "核心事件2（可跨月）"]
    }},
    {{
      "month": "2月",
      "content": "该月份发生的具体事件内容",
      "impact": "该月份事件产生的影响和意义，特别是对后续事件的推动作用",
      "core_events": ["核心事件1", "核心事件2（可跨月）"]
    }}
  ]
}}, 
{{
  "topic": "第二个主题",
  "detailed_description": "...",
  "monthly_description": ["..."]
}}
]

## 四、注意事项
1. 严格遵循JSON格式规范，确保输出可被正确解析
2. 月度描述需按时间顺序排列
3. 核心事件应简洁明了，突出关键内容
4. 所有内容必须基于人物画像和提供的重要节点事件，保持逻辑一致性
5. 语言表达需专业、流畅，避免冗余和模糊表述
6. 重点体现事件的因果关系和后续影响，确保时间线的连贯性和深度
7. 灵活处理时间覆盖范围，无需强制覆盖全年

五、**输出要求**：重要：请严格按照格式输出JSON结果，不包含任何无关解释、注释或代码，直接以[]开头。**在JSON字符串双引号内避免使用双引号，只在外部有双引号，避免双引号嵌套问题**，如果不得不在字符串内表示引号，请使用#包裹特殊字段，但要保证外部双引号的存在。请确保每个字符串和键一定被英文半角双引号"包裹。

---
{event_type}类别的重要节点事件：{important_nodes}
人物画像：{persona}
'''
template_personal_changes = '''
请基于以下人物画像数据和指定主题，**创作该人物在未来一年（2025年）可能发生的事件时间线**。我们的目标是通过一系列事件来修改画像，**创作不在当前画像中的全新变化**，而不是基于现有画像进行推理。

## 一、人物画像字段说明
人物画像包含以下主要字段（事件影响变动时attribute必须严格对应这些字段名）：
- 不可变化字段：name(固定), birth(固定), age(自动增长), gender(固定), birth_place(固定)
- 可变化字段：
  - 地址信息：home_address, workplace
  - 职业信息：job, occupation, work_desc, salary
  - 身体信息：body (包含height, weight, BMI)
  - 家庭信息：family
  - 兴趣爱好：hobbies, favorite_foods, preference
  - 目标：aim
  - 健康状况：healthy_desc
  - 生活方式：lifestyle_desc
  - 经济状况：economic_desc
  - 经历描述：experience_desc
  - 关系信息：relation
  - 其他信息：education, nationality, personality (包含mbti, traits), memory_date

## 二、历史主题记录
以下是已经生成的事件主题记录，请确保新生成的事件主题与之不同，避免重复：
{history}

## 三、事件时间线定义
事件时间线是指一系列连续发生的事件，这些事件会导致人物在多个方面发生全新变化。每个事件时间线应包含：
- 一个核心事件：引发后续变化的主要事件
- 发展过程：事件的发展变化过程
- 后续体现：事件对人物生活的持续影响
- 多属性影响：一个事件可能导致多个属性发生变化

## 四、主题要求
本次创作的主题为：**{event_type}**
请围绕该主题创作一个完整的事件时间线，确保主题明确且贯穿始终。

## 五、创作要求
1. **创作全新事件**：所有事件必须是不在当前画像中的全新事件，能够引发全新的变化
2. **事件时间线**：事件应具有时间顺序，形成完整的发展轨迹，时间线的开始时间可以随机选取，不一定从年初开始
3. **多属性影响**：一个事件可以影响多个属性，体现事件的全面影响
4. **明显改变生活习惯和偏好**：必须对生活习惯（lifestyle_desc）和偏好（preference）数据产生明显改变，一个人一年一定会发生一些变化，不可能和年初画像一样
5. **变化创新性**：事件和变化应具有创新性和故事性，能够显著改变人物的生活轨迹
6. **详细描述**：每个事件应包含详细的发展过程和后续体现
7. **严格对应字段名**：影响变动中的attribute必须严格对应人物画像中的字段名
8. **为年底新画像奠定基础**：所有事件和变化应共同构成年底可能的全新人物画像
9. **避免主题重复**：新生成的事件主题必须与历史主题记录中的主题不同，确保事件多样性
10. **主题聚焦**：必须围绕指定的主题创作事件时间线，确保主题明确且贯穿始终

### 示例：爱好变化事件时间线
以增加"打羽毛球"爱好为例：
1. 核心事件：被朋友邀请尝试打羽毛球
2. 发展过程：从尝试到逐步养成习惯
3. 后续体现：影响生活习惯、社交圈（新认识朋友）等
4. 事件序列：被邀请尝试 → 因空闲开始定期打 → 小有成就 → 因忙碌耽搁 → 重新开始 → 认识新朋友

我以爱好作为示例，但你需要考虑其他方面的变化，如工作、生活方式、社交圈等。
## 六、输出格式要求
请严格按照以下JSON数组格式输出，包含topic、detailed_description和monthly_description字段：

### 输出格式示例
```json
[
  {{
    "topic": "打羽毛球爱好养成记",
    "detailed_description": "从被朋友邀请尝试打羽毛球，到逐步养成习惯并认识新朋友的完整过程，显著改变了生活习惯和偏好",
    "monthly_description": [
      {{
        "month": "2025-03",
        "content": "被朋友邀请尝试打羽毛球，第一次接触这项运动，虽然打得不好但感觉很有趣",
        "impact": "开启了羽毛球爱好的起点，为后续持续参与奠定了基础",
        "core_events": ["首次接触羽毛球"]
      }},
      {{
        "month": "2025-04",
        "content": "因工作压力大、时间空闲，开始每周抽时间打羽毛球，逐渐喜欢上这项运动",
        "impact": "将羽毛球从偶尔尝试转变为定期活动，养成初步习惯",
        "core_events": ["开始每周定期打羽毛球"]
      }},
      {{
        "month": "2025-06",
        "content": "经过几个月的练习，打球技术有了明显进步，在一次业余比赛中获得小组第三名，增强了信心",
        "impact": "技术进步和比赛成绩提升激发了更大的兴趣和投入",
        "core_events": ["技术进步明显", "业余比赛获小组第三名"]
      }},
      {{
        "month": "2025-08",
        "content": "因项目忙碌，暂时减少了打球次数，每周只能打一次，但仍然坚持",
        "impact": "尽管时间减少但保持了习惯，体现了对羽毛球的持续兴趣",
        "core_events": ["因工作忙碌减少打球次数但坚持参与"]
      }},
      {{
        "month": "2025-10",
        "content": "项目结束后，重新开始定期打羽毛球，并且加入了一个羽毛球俱乐部，认识了很多志同道合的朋友",
        "impact": "通过加入俱乐部扩大了社交圈，进一步巩固了羽毛球爱好",
        "core_events": ["重新开始定期打球", "加入羽毛球俱乐部"]
      }},
      {{
        "month": "2025-12",
        "content": "通过羽毛球俱乐部认识了很多新朋友，打球已经成为生活中重要的一部分，生活习惯和偏好发生了明显改变",
        "impact": "羽毛球爱好完全融入生活，成为生活方式的重要组成部分",
        "core_events": ["羽毛球成为生活重要部分"]
      }}
    ]
  }}
]
```

---

人物画像：{persona}
'''

template_analyse = """
请基于以下人物画像数据，完成三项核心任务，输出结果需兼具全面性与结构化，为后续生成人物生活数据提供精准依据：
一、综合信息提炼
撰写一份整合描述，需系统覆盖以下核心维度：①基本信息（年龄、性别、学历、籍贯等关键标识）；②生活习惯（作息规律、饮食偏好、运动频率、兴趣爱好等日常行为特征）；③社交状态（社交圈规模、主要交往对象类型、社交频率与场景）；④工作情况（职业类型、岗位层级、行业属性等基础信息）；⑤经济状况（收入水平、消费习惯、负债/资产情况等）；⑥家庭结构（婚姻状况、亲属关系、家庭角色）；⑦个人特质（性格倾向、价值观、目标诉求等）；⑧重要日期（生日，结婚纪念日等）。描述需突出各维度关键信息，避免冗余。
二、专项深度分析
针对以下三个方向进行精准拆解，输出明确结论：
1. 居住情况：明确当前同住家庭成员构成（姓名、关系、年龄等），同步提炼居住相关特征（如住房类型、居住城市/区域、居住环境偏好、居家活动重点区域等）；
2. 工作情况：梳理工作中核心关联人物（如上级、下属、重要合作对象及关系属性），总结工作关键特征（如工作节奏、核心职责、办公模式、职业发展阶段等）；
3. 生活情况，梳理日常生活中常用联系人，总结生活中包括工作日非工作时间和非工作日可能的行为特征（如生活节奏，常见行为，生活阶段等）。
4. 日常轨迹：以“工作日”为核心场景，还原典型一天的生活常规轨迹，按时间顺序清晰呈现各时段主要活动及行为目的（需包含起床、通勤、工作、餐饮、休闲、睡眠等关键节点），不需要具体时间和具体事件。
三、事件分析
分析该人物可能生活中可能涉及的以下事件类别对应比例的合理列表。事件类别：Career、Education、Relationships、Family&Living Situation、Personal Life、Finance、Health、Unexpected Events、Other。
{persona}
最终把以上两个任务的输出组织成以下格式输出，在<analyse>输出信息分析，在<percent>输出一个字典json，包含对映类别的百分比占比（例子：25%）。json直接以{{}}作为开头结尾，不要有多余文本。

<analyse>
1.信息提炼：
2.深度分析：
2.1：居住情况：
2.2：工作情况：
2.3：生活情况：
2.4：工作日轨迹：
</analyse>
<percent>
{{"Career":"","Education":"","Relationships":"","Family&Living Situation":"","Personal Life":"","Finance":"","Health":"","Unexpected Events":"","Other":""}}
</percent>
"""

template_important_events_generation = '''
请基于以下人物画像、事件类别和已有重要事件，为该类别生成5-20个可能发生的重要事件,将总事件类别补充到15个以上，若已有重要事件已经比较多，则可以少生成。（至少生成五个）

## 输入数据

### 人物画像
{persona}

### 事件类别
{event_type}

### 已有重要事件
{existing_events}

## 任务要求

1. **重要事件定义**：
   - 满足以下任一条件的事件即可被视为重要事件：
   - 具有影响性或需要产生后续的事件
   - 对人物生活、工作、学习有重要意义的事件
   - 带来明显变化的事件
   - 与社交关系相关联并对人物产生影响的事件
   - 时间跨度长的事件
   - 不寻常的事件

2. **事件特点**：
   - 每个事件应与人物画像高度相关，符合人物的背景、性格和生活方式
   - 事件应具有多样性，涵盖该类别的不同方面，包含积极（如进步，升职）、中性（如购置物件）与消极（如麻烦）事件（消极事件不要超过5个）
   - 事件应具体、详细，包含明确的主题和潜在影响
   - 可针对画像属性思考各类变动，如关系变动（认识新朋友、与重要人物产生矛盾）、生活环境变动、工作变动、资产物件变动、爱好偏好变动等
   - 事件需符合指定的事件类型
   - 需考虑社交关系对事件的影响：基于人物画像中的重要社交关系（如家人、朋友、同事、合作伙伴等），分析这些关系人物可能发生的事件及其对该人物的影响

3. **避免重复事件**：
   - 请仔细参考已有的重要事件列表
   - 确保生成的新事件与已有事件不重复
   - 如果已有事件比较全面，可以适当扩展或衍生相关的后续事件
   - 生成事件之间尽量有大的差异，不要过于相似
   
4. **输出格式**：
   请严格按照以下JSON数组格式输出：
   [
     {{
       "name": "事件名称",
       "description": "事件详细描述",
       "reason": "为什么这是重要事件（有影响、需要后续、与重要社交关系相关等）",
       "potential_impact": "事件可能产生的影响"
     }}
   ]

## 输出要求

- 输出必须是严格的JSON格式，不得包含任何其他文本
- 每个事件类别需生成10-20个事件
- 事件应与人物画像一致，符合人物的生活场景
- 事件描述应清晰、具体，易于理解
- 需包含至少3-5个基于社交关系分析生成的事件
- 生成的事件需与已有重要事件无重复
'''

template_timeline_validation = '''
请基于以下人物画像和合并后的时间线，对时间线进行全面校验和优化，确保时间线合理、真实、多样、丰富，但又不要过于故事性，变化不要太突兀或者过多导致人物不正常忙碌，全年应有忙碌的时候和清闲的时段。

## 输入数据

### 人物画像
{persona}

### 合并后的时间线
{merged_timeline}

## 校验维度

1. **合理性与真实性校验**：
   - 事件时间安排是否符合人物画像和真实生活规律
   - 事件之间的因果关系和发展脉络是否合理
   - 事件描述是否具体、详细，符合现实生活
   - 事件密度是否适中，避免过于密集或过于稀疏
   - 季节变化、节假日等时间因素的影响是否合理体现

2. **多样性与丰富性校验**：
   - 事件类型是否多样化，涵盖工作、生活、学习、社交等多个方面
   - 主题是否丰富，避免单一主题贯穿全年
   - 事件描述是否有足够的细节，避免过于笼统
   - 是否包含足够的日常事件和重要事件的平衡

3. **故事性与变化节奏校验**：
   - 避免过于戏剧化的情节和冲突，保持真实感
   - 事件变化是否自然流畅，避免突兀的转折
   - 长期目标和短期活动是否合理结合
   - 是否体现了人物的成长和发展，但避免不切实际的快速变化
   - 一些事件是否过于巧合，变化过于突兀突然。

4. **逻辑一致性校验**：
   - 同一月份内的事件是否逻辑连贯
   - 不同月份之间的事件是否有合理的衔接和延续
   - 事件对人物画像的影响是否一致
   - 主题之间是否有合理的关联和转换

## 优化要求

1. **修改建议（思考过程）**：
   - 针对校验中发现的问题，提出具体的修改建议
   - 明确指出需要修改的事件、月份或主题
   - 提供修改的理由和优化方向

2. **主题优化能力**：
   - 你可以修改主题里事件的安排和发展顺序
   - 你可以删除不适合的主题或事件
   - 你可以新增更多变化的事件主题
   - 请尽量保障主题事件多样又合理

3. **重生成要求**：
   - 基于校验结果和修改建议，重生成优化后的时间线
   - 保持原有时间线的结构和核心内容
   - 确保优化后的时间线更符合合理性、真实性、多样性和自然变化的要求
   - 避免过度创作，保持真实生活的质感
   
## 输出格式要求

请严格按照以下JSON格式输出优化后的时间线：

{{
  "comprehensive_summary": "该时间线的全面总结描述，包括全年的发展脉络、核心内容和整体趋势",
  "monthly_details": [
    {{
      "month": "1月",
      "themes": [
        {{
          "theme_name": "主题1名称",
          "theme_description": "主题1的详细描述和内容概述"
        }},
        {{
          "theme_name": "主题2名称",
          "theme_description": "主题2的详细描述和内容概述"
        }}
      ],
      "events": [
        {{
          "description": "事件1的详细描述（经过优化和丰富）",
          "start_time": "2025-01-01 09:00:00",
          "end_time": "2025-01-01 12:00:00",
          "belongs_to_theme": "主题1名称"
        }},
        {{
          "description": "事件2的详细描述（经过优化和丰富）",
          "start_time": "2025-01-15",
          "end_time": "2025-01-20",
          "belongs_to_theme": "主题2名称"
        }}
      ],
      "impact": {{
        "profile_changes": "画像信息产生的具体变化（如性格、生活习惯、社交圈等方面的变化）",
        "life_impact": "对个人生活产生的具体影响，包括作息、习惯、活动安排、心情等",
        "future_impact": "对未来发展产生的具体影响"
      }}
    }},
    // 其他月份（直到12月）
  ]
}}

## 注意事项

1. 严格遵循JSON格式规范，确保输出可被正确解析,不要输出任何额外的文本或注释，只输出JSON对象。以{{}}开头。
2. 所有修改和优化必须基于人物画像和真实生活逻辑
3. 保持事件的多样性，但避免过度创作
4. 确保事件变化自然流畅，避免突兀的转折
5. 保持时间线的逻辑连贯性和内容丰富性
6. 在JSON字符串值中避免使用双引号，如果需要表示引号，请使用[]或其他替代符号，或者使用转义字符\\"
'''

template_timeline_final_generation = '''
请基于以下人物画像、多个原始时间线、修改建议和全年总结，合并并创建一个全新的、统一的一年时间线。你可以：修改调整各类事件、新增事件、改变某个时间线的发展逻辑、抛弃某个时间线。最终生成一个丰富、多样、真实、合理、没有矛盾、体现发展变化、真实世界复杂性的合并后的一个一年时间线数据。

## 输入数据

### 人物画像
{persona}

### 多个原始时间线
{original_timelines}

### 冲突分析结果（包含修改建议和全年总结，作为参考，可不完全遵循）
{conflict_analysis_result}

## 任务要求

1. **时间线创建与整合合并**：
   - 你可以完全自由地处理原始时间线：合并事件、改变发展逻辑、抛弃某个时间线。
   - 最终只生成一个统一的时间线，不再保留多个独立时间线
   - 确保合并或创建后的时间线结构清晰、层次分明
   - 可以整合来自不同时间线的相关事件，形成连贯的事件序列
   - 根据人物画像和全年总结，合理增加缺失的重要事件
   - 确保新增事件与已有事件在时间、逻辑上协调一致
   - 覆盖更多符合该类别的重要场景和活动
   - 未来一个人一年生活的丰富性，尽量保留多主题的事件。你可以合理新增一些时间线主题。

2. **事件处理自由性**：
   - 可以修改调整任何原始事件的内容、时间、地点、人物或发展脉络
   - 可以新增全新的事件，丰富时间线内容
   - 可以删除不合理或不符合整体规划的事件
   - 可以改变事件之间的因果关系或发展逻辑

3. **内容优化与丰富**：
   - 提升事件描述的质量和详细程度，使时间线更加生动具体
   - 强化事件与人物画像的匹配度，确保所有内容符合人物设定
   - 增加体现真实世界复杂性的细节，如意外情况、临时变化、多重任务并行等
   - 修正不合理或不连贯的部分
   - 要保证一年数据的丰富性，主题的多样性，变化发展的多样性。
   - 新增一些主题时间线的互相影响。

4. **发展变化体现**：
   - 确保时间线体现人物或事物的发展变化，展示成长、进步或衰退的过程
   - 设计有连贯性的事件序列，反映长期目标的逐步实现或生活状态的改变
   - 包含阶段性的成就、挑战和转折点

5. **冲突消解**：
   - 仔细分析多个时间线之间存在的冲突点，根据修改建议进行消解
   - 确保时间、地点、人物、事件逻辑上的一致性
   - 解决事件间的因果关系矛盾

5. **结构完善**：
   - 确保整个时间线的结构完整，包含清晰的类别和全面总结
   - comprehensive_summary需要详细总结一年来的大概发展脉络和重要事件点，呈现整体发展趋势
   - 按月份组织事件，保证每个月的内容详细且连贯
   - 每个月增加monthly_summary字段，描述该月的主要发展脉络和主要事件
   - 突出每个月事件的影响和变化

6. **主题管理**：
   - 为每个月撰写合适的主题数组，反映该月的该主题的核心内容和发展重点
   - 确保每个事件都有明确的归属主题
   - 保持主题间的逻辑连贯性和发展脉络，新增事件来保障事件的连贯性（逻辑连贯）和体现性（如新增爱好，后续要有相关爱好事件（不一定有逻辑连贯））
   - 根据每个主题的开始/结束时间分配到对应月份的主题数组，若主题具有影响性则主题事件结束后应增添一些体现其影响和后续发展的事件。
   - 同一主题在不同月份出现时，必须使用完全相同的theme_name，确保主题名称的一致性和可识别性
   
7. **影响分析**：
   - 分析事件对人物画像的改变（profile_changes）
   - 阐述对个人生活的具体影响（life_impact）
   - 说明对未来发展的长期影响（future_impact）

8. **逻辑与真实性**：
   - 确保事件间有合理的因果关系和发展脉络
   - 保证时间线整体的逻辑一致，避免任何矛盾或冲突
   - 体现真实世界的复杂性，包括不可预测性、权衡取舍和多重因素影响
   - 确保事件交叉并行，反映现实生活的多样性和忙碌性

9. **创新与合理性平衡**：
   - 鼓励创新思维，允许开辟新的事件发展方向
   - 同时确保所有内容保持合理，符合现实世界的基本规律
   - 平衡事件的多样性和整体的连贯性

10. **年度完整性**：
    - 覆盖完整的一年时间（1月到12月）
    - 确保每个月份都有足够的内容，避免出现空白期
    - 体现季节变化、节假日等时间因素的影响

## 输出格式要求

Please严格按照以下JSON数组 format output最终合并后的时间线（必须只包含一个时间线对象）：

{{
  "comprehensive_summary": "该时间线的全面总结描述，包括全年的发展脉络、核心内容和整体趋势",
  "monthly_details": [
    {{
      "month": "1月",
      "monthly_summary": "该月的主要发展脉络和主要事件总结",
      "themes": [
        {{
          "theme_name": "主题1名称",
          "theme_description": "主题1的详细描述和内容概述"
        }},
        {{
          "theme_name": "主题2名称",
          "theme_description": "主题2的详细描述和内容概述"
        }}
      ],
      "events": [
        {{
          "description": "事件1的详细描述（经过优化和丰富）",
          "start_time": "2025-01-01 09:00:00",
          "end_time": "2025-01-01 12:00:00",
          "belongs_to_theme": "主题1名称"
        }},
        {{
          "description": "事件2的详细描述（经过优化和丰富）",
          "start_time": "2025-01-15",
          "end_time": "2025-01-20",
          "belongs_to_theme": "主题2名称"
        }}
      ],
      "impact": {{
        "profile_changes": "画像信息产生的具体变化（如性格、生活习惯、社交圈等方面的变化）",
        "life_impact": "对个人生活产生的具体影响，包括作息、习惯、活动安排、心情等",
        "future_impact": "对未来发展产生的具体影响"
      }}
    }},
    {{
      "month": "2月",
      "monthly_summary": "该月的主要发展脉络和主要事件总结",
      "themes": [
        {{
          "theme_name": "主题1名称",
          "theme_description": "主题1的详细描述和内容概述"
        }},
        {{
          "theme_name": "主题3名称",
          "theme_description": "主题3的详细描述和内容概述"
        }}
      ],
      "events": [
        {{
          "description": "...",
          "start_time": "...",
          "end_time": "...",
          "belongs_to_theme": "主题1名称"
        }},
        {{
          "description": "...",
          "start_time": "...",
          "end_time": "...",
          "belongs_to_theme": "主题3名称"
        }}
      ],
      "impact": {{
        "profile_changes": "...",
        "life_impact": "...",
        "future_impact": "..."
      }}
    }}

  ]
}}

## 注意事项

1. 严格遵循JSON格式规范，确保输出可被正确解析,不要输出任何额外的文本或注释，只输出JSON数组。以{{}}开头。
2. 所有内容必须基于输入数据进行合并和优化，不得凭空捏造不符合人物画像的情节
3. 月份必须按时间顺序排列（1月到12月）
4. 事件描述要具体、生动，有足够的细节
5. 确保时间线的逻辑连贯性和内容丰富性
6. 输出必须是一个统一、合并后的时间线，而不是多个独立的时间线
7. 确保所有原始时间线中的重要信息都被合理整合到最终时间线中
8. 注意处理不同时间线之间的事件关联和因果关系
9. **在JSON字符串值中避免使用双引号，如果需要表示引号，请使用[]或其他替代符号，或者使用转义字符\"**
'''

template_convert_timeline_to_events = '''
# 任务：将时间线数据转换为主题事件数组并进行优化，体现事件发展和轨迹

## 任务明确要求：
1. 提取已有事件：从不同主题事件中提取所有现有事件，**必须确保不遗漏任何原始事件**
2. 事件组合：将有关联的事件组合为一个主题
3. 事件优化（组合主题后）：
   - 从整体事件的视角增加事件（新的发展或相关事件，不要与原安排的其他事件冲突）
   - 修改事件描述（尽量遵循原每月安排）
   - 补充逻辑链不完善的事件
   - 重写主题内事件的描述
   - 整合事件：如同一主题、同一时间段的多个相似事件可以合并（例如：四月份发生了两次去迪士尼，可以用一个事件描述四月份那两天去了两次迪士尼）

## 输入数据结构：
输入数据包含按月份组织的时间线信息，每个月份包含以下结构：
- themes：主题数组，每个主题包含theme_name和theme_description
- events：事件数组，每个事件包含description、start_time、end_time和belongs_to_theme

## 输出要求：
1. **主题事件数组结构**：输出一个包含多个主题对象的数组，每个主题对象包含以下字段：
   - theme_name：主题名称
   - theme_description：主题详细描述
   - events：该主题下的事件数组，包含原数据中的相关事件以及新增的因果事件

2. **事件字段要求**：
   - name：事件名称（简洁描述事件核心内容）
   - description：事件详细描述（**请根据原始信息重写，使其更加详细和生动，涵盖所有事件细节**）
   - date：开始日期至结束日期的格式，如"2025-01-01至2025-01-03"


3. **事件发展轨迹要求**：
   - 事件应按时间顺序排列，体现主题的发展脉络
   - 需包含相关事件和因果事件，展示事件之间的逻辑关系
   - 确保事件之间的逻辑连贯性、相关性


4. **主题优化**：
   - 可以修改主题名称和描述，使其更准确地反映事件发展
   - 保障主题事件的多样性和合理性

## 输出格式：
请以JSON数组格式输出，每个主题是一个包含theme_name、theme_description和events字段的对象。

例如：
[
    {{
        "theme_name": "家庭健康管理",
        "theme_description": "丈夫确诊高血压后，家庭健康管理的发展过程",
        "events": [
            {{
                "name": "丈夫确诊高血压",
                "description": "丈夫拿到体检报告，确诊为原发性高血压，医生开了药并嘱咐低盐饮食",
                "date": "2025-01-06至2025-01-06"
            }},
            {{
                "name": "调整家庭饮食",
                "description": "马晓梅开始学习低盐食谱，尝试用葱姜蒜提香，逐步调整家庭饮食口味",
                "date": "2025-01-07至2025-01-15"
            }},
            {{
                "name": "建立健康监测习惯",
                "description": "马晓梅为丈夫购买了血压计，建立了每日监测和记录血压的习惯",
                "date": "2025-01-16至2025-01-31"
            }}
        ]
    }},
    {{
        "theme_name": "子女教育督导",
        "theme_description": "子女学业发展和行为引导的过程",
        "events": [
            {{
                "name": "儿子成绩不理想",
                "description": "儿子期末考试成绩不理想，沉迷手机游戏的问题开始显现",
                "date": "2025-01-25至2025-01-25"
            }},
            {{
                "name": "制定手机使用规则",
                "description": "马晓梅与儿子沟通，制定了手机使用规则，平时每天最多玩半小时",
                "date": "2025-01-26至2025-01-26"
            }},
            {{
                "name": "寻找替代兴趣",
                "description": "马晓梅开始为儿子寻找除手机游戏以外的兴趣点，尝试引导其参与有益活动",
                "date": "2025-01-27至2025-01-31"
            }}
        ]
    }}
]

## 输入数据：
{timeline_json}
'''

template_generate_timeline_summaries = '''
# 任务：根据时间线事件数据生成月度总结、影响总结和全面总结

## 输入数据结构：
输入是一个包含时间线事件数据的JSON对象，结构如下：
{{
    "comprehensive_summary": "",
    "monthly_details": [
        {{
            "month": "YYYY-MM",
            "monthly_summary": "",
            "events": [
                {{
                    "name": "事件名称",
                    "description": "事件详细描述",
                    "date": "YYYY-MM-DD至YYYY-MM-DD",
                    "belongs_to_theme": "主题名称"
                }}
                ...
            ],
            "impact": ""
        }}
        ...
    ]
}}

## 输出要求：
1. 请基于输入的事件数据，为每个月生成：
   - monthly_summary：该月的主要发展脉络和主要事件总结
   - impact：该月事件对未来的影响，记录下产生了什么变化（相对于画像，重要，要明确画像产生了什么改变）和关键事件（一个月不超过3个）。

2. 请为整个时间线生成：
   - comprehensive_summary：该时间线的全面总结描述，包括全年的发展脉络、核心内容和整体趋势

3. 输出格式必须与输入格式完全一致，只需要填充空字符串字段即可。

4. 所有总结必须基于输入的事件数据，保持客观、全面、连贯。

## 输出格式：
请直接输出包含所有填充字段的完整JSON对象，不要添加任何其他文本。

## 输入数据：
{timeline_json}
'''

template_generate_insertable_events = '''
请基于以下时间线数据和人物画像，生成15个左右的低频事件。注意时间线的时间，应都在2025年，插入事件要思考是否符合前后事件的逻辑，不产生矛盾。

## 低频事件定义
低频事件是指在一年内发生频率较低（通常不超过5次，推荐1-4次）的事件，可能是比较重要，或者成本较高，或者难以多次进行，或者只能进行几次的事件。参考以下类型：
- **全新体验事件**：个人从未经历过的新奇尝试，如第一次尝试滑翔伞、学习陶艺制作等
- **画像关联事件**：与用户画像中兴趣、职业或关键特征相关的特定事件
- **丰富生活体验**：多样化的生活场景，如参观特色展览、参加主题沙龙等
- **特殊意义事件**：对个人有特殊意义但不频繁发生的事件
- **小概率事件**：意外的低概率事件（可能积极或消极，但不要有过大的影响）
- **需准备事件**：需要较长时间准备才能发生的事件
- **不根据画像事件**：与人物画像中偏好、兴趣或特征无关的纯随机体验，甚至可以是人物不喜欢或不符合画像的经历，如一个不常出门的人被邀请进行了一次七日游，一个没接触过艺术的人观赏了一次画展等
- **不根据已有事件的事件**：与现有事件无关的新增体验，体现个人的想法安排，应是难得的一次经历：如一场个人定制的旅行、一次演唱会参与等
- **高成本事件**：成本（时间/精力/金钱）较高的事件，如购买昂贵的商品、一次大的活动（如一次大型会议、一次购物大促等），前往迪士尼等许多a追求的但是难以实现的精致事件

## 输入数据

### 人物画像
{persona}

### 现有时间线
{timeline}


## 任务要求

1. **事件类型**：
   基于低频事件的定义，生成低频事件。**重要要求：低频事件定义中的每个类别（全新体验事件、画像关联事件、丰富生活体验、特殊意义事件、小概率事件、需准备事件、不根据画像事件、不根据已有事件的事件）至少生成一个事件**。
   
2. **事件信息**：
   - 每个事件需要包含：事件名称、事件描述、起始时间、结束时间
   - 时间范围必须在2025年内，格式为YYYY-MM-DD HH:MM:SS或YYYY-MM-DD，具体格式根据事件持续时间合理选择
   - 事件描述需具体生动，包含时间、地点、活动细节等丰富内容
   - 事件应与人物画像和现有时间线保持逻辑一致，不产生矛盾

3. **事件特点**：
   - 事件应具体、详细，包含明确的时间、地点、人物和活动内容
   - 允许与画像无关的全新体验事件
   - 允许生成与人物画像中偏好、兴趣或特征无关的纯随机体验事件
   - 允许生成人物不喜欢/不符合画像但在现实生活中可能经历的事件
   - **重要：避免与现有时间线中的事件重复**（如现有时间线数据有婚礼事件，则你不考虑生成相关事件，要做到和已有事件不同）
   - **事件发生频率应多样化，不可以都为一次，尽量丰富（例如：部分事件发生1次，部分发生2次，部分发生3次等）**
   - **生成的事件应与已有时间线的事件明显不同，避免相似或重复**
   - **重要要求：为了保持时间线的平衡性，请尽量将事件均匀分布在2025年的各个月份中，每个月份的事件数量应尽量平均**
   - 平衡常见的低频事件和新颖的尝试体验，避免过于单一

4. **Event Type 详细描述**：
   - Career: 职业发展、工作变动、项目完成、职位晋升、求职、辞职、创业等
   - Education: 学习、培训、考试、学位获得、技能提升、在线课程、学术活动等
   - Relationships: 恋爱、婚姻、分手、友谊、社交活动、家庭关系等
   - Family&Living Situation: 家庭生活、居住环境变化、家庭成员互动、搬家、装修等
   - Personal Life: 个人兴趣、娱乐活动、旅行、运动、爱好、个人成长等
   - Finance: 财务状况、投资、消费、收入变化、理财活动、购买大件物品等
   - Health: 健康状况、医疗活动、运动健身、饮食习惯、体检、治疗等
   - Unexpected Events: 意外情况、突发事件、不可预测的事件等
   - Other: 其他无法归类的事件

5. **输出格式要求**：
   请严格按照以下JSON数组格式输出，每个事件包含：
   - name：事件名称
   - description：事件详细描述
   - start_time：事件起始时间数组（格式：YYYY-MM-DD HH:MM:SS 或 YYYY-MM-DD），表示事件多次发生的起始时间
   - end_time：事件结束时间数组（格式：YYYY-MM-DD HH:MM:SS 或 YYYY-MM-DD），表示事件多次发生的结束时间
   - frequency：事件发生次数（整数）
   - type：事件类别（从Career、Education、Relationships、Family&Living Situation、Personal Life、Finance、Health、Unexpected Events、Other中选择）

   [
     {{
       "name": "事件名称",
       "description": "事件详细描述，包含时间、地点、人物和活动内容",
       "start_time": ["2025-01-01 09:00:00", "2025-02-15 14:30:00"],
       "end_time": ["2025-01-01 12:00:00", "2025-02-15 17:00:00"],
       "frequency": 2,
       "type": "Personal Life"
     }}
   ]

## 注意事项

1. 严格遵循JSON格式规范，确保输出可被正确解析
2. 事件总数控制在10个左右
4. 所有事件必须严格符合低频事件的定义，一年发生次数不超过5次，避免生成日常高频发生的事件
5. 事件描述要具体、生动，包含足够的细节（时间、地点、活动内容等）
7. 事件类别应充分考虑，合理分布
8. **重要要求：事件发生频率应多样化，不可以都为一次，尽量丰富（例如：部分事件发生1次，部分发生2次，部分发生3次等）**
9. **重要要求：时间安排上尽量不与已有时间线中的事件冲突**
10. **重要要求：生成的事件必须与已有时间线的事件明显不同，避免任何形式的相似或重复**
13. 生成的事件应符合现实生活逻辑，避免过于荒诞或不切实际的内容
14. 仅输出JSON格式内容，直接以[]作为开头结尾
15. 不添加任何额外文本、注释或代码块标记
16. **特别注意**：在JSON字符串值中避免使用双引号，如果需要表示引号，请使用[]或其他替代符号，或者使用转义字符\\""

下面是一些事件参考（不一定选择）：
### 参考事件：
{reference_events}
'''

template_generate_creative_events = '''
请基于以下人物画像，生成10-16个左右能产生显著变动和影响的变化事件，主要聚焦于个人生活的变化和发展转折点。这些事件应展现完整的事因链条，具有故事性和客观性，每个事件主题独立且不同。注意时间线的时间，应都在2025年。
变化事件应体现个人生活的重要转折点或发展变化，包括但不限于偏好改变、爱好发展、关系建立、新颖体验、画像信息更新、运动健康变化、目标计划调整等多种类型。

## 输入数据

### 人物画像
{persona}

### 现有时间线
{timeline}

## 任务要求

1. **变化事件定义(满足一项即可)**：
   - 事件应体现个人生活的重要转折点或发展变化
   - 变化可涉及画像信息、偏好、爱好、习惯、生活状态（旅行、出差、居住地、作息等）、新目标想法
   - 包含类似于认识新朋友（关系变动）、接触新领域、放弃旧的爱好等个人变化
   - 这些事件将展现一年生活的发展变化
   - 事件应基于2025年，展现全年生活的变化发展
   - 不同事件间主题应保持独立，避免相互关联（如：认识新朋友 vs 开始计划跑马拉松）

2. **变化事件类型示例**：
   - **偏好变化**：例如不再吃香菜、开始喜欢喝茶、对某种音乐风格的喜爱等
   - **爱好发展**：例如开始健身、学习绘画、参加摄影俱乐部、养宠物等
   - **关系建立**：例如认识新朋友、建立新的合作关系、参加社交聚会等
   - **新颖体验**：例如朋友推荐尝试某种新活动、探索新的餐厅或旅游地点、体验新的娱乐方式等
   - **画像信息更新**：例如居住地搬迁、职业变动、学习新技能、信仰观念转变等
   - **运动健康变化**：例如小病康复、发现健康问题，减肥增肌等
   - **目标计划调整**：例如备战马拉松、制定减肥计划、规划职业发展路径等

3. **事件信息**：
   - 每个事件需要包含：事件名称、事件描述、起始时间、结束时间
   - 时间范围需要设定在2025年内
   - 事件应与人物画像保持基本一致，但可以展现新的发展方向

4. **事件特点**：
   - 事件应具体、详细，包含明确的时间、地点、人物和活动内容
   - 事件应具有故事性，能够展现一个完整的情节发展
   - 事件应客观真实，符合生活逻辑和社会背景
   - 每个事件应展现独立的主题，与其他事件无直接关联
   - 事件应体现变化性，与已有时间线事件差异化

5. **Event Type 详细描述**：
   - Career: 职业发展、工作变动、项目完成、职位晋升、求职、辞职、创业等
   - Education: 学习、培训、考试、学位获得、技能提升、在线课程、学术活动等
   - Relationships: 恋爱、婚姻、分手、友谊、社交活动、家庭关系等
   - Family&Living Situation: 家庭生活、居住环境变化、家庭成员互动、搬家、装修等
   - Personal Life: 个人兴趣、娱乐活动、旅行、运动、爱好、个人成长等
   - Finance: 财务状况、投资、消费、收入变化、理财活动、购买大件物品等
   - Health: 健康状况、医疗活动、运动健身、饮食习惯、体检、治疗等
   - Unexpected Events: 意外情况、突发事件、不可预测的事件等
   - Other: 其他无法归类的事件

6. **输出格式要求**：
   请严格按照以下JSON数组格式输出，每个事件包含：
   - name：事件名称
   - description：事件详细描述
   - start_time：事件起始时间（格式：YYYY-MM-DD HH:MM:SS 或 YYYY-MM-DD，必须是2025年）
   - end_time：事件结束时间（格式：YYYY-MM-DD HH:MM:SS 或 YYYY-MM-DD，必须是2025年）
   - type：事件类别（从Career、Education、Relationships、Family&Living Situation、Personal Life、Finance、Health、Unexpected Events、Other中选择）
   - event_analysis：事件分析（详细分析事件前后的影响或与现有时间线的逻辑关系）

   [
     {{
       "name": "事件名称",
       "description": "事件详细描述，包含时间、地点、人物和活动内容，以及事件的起因、经过和预期结果",
       "start_time": "2025-01-01 09:00:00",
       "end_time": "2025-01-01 12:00:00",
       "type": "Personal Life",
       "event_analysis": "分析此事件与现有时间线的关系，说明它是独立事件还是与现有事件有关联，以及可能产生的影响"
     }}
   ]

## 注意事项

1. 严格遵循JSON格式规范，确保输出可被正确解析
2. 事件应聚焦于个人生活的变化转折点，不一定要求有多重要或影响
3. 重点关注故事性和客观性，每个事件应有完整的情节发展
4. 确保不同事件间主题独立，避免相互关联
5. 避免与现有时间线中的事件重复，要体现差异化变化
6. 事件必须发生在2025年，展现一年的生活变化发展，事件的发生时间可以多样分布在各个月份，不要过于集中。
8. 从自身变化、周遭变化、客观事件发展、环境政策随机事件等多个方面考虑
9. **特别注意**：在JSON字符串值中避免使用双引号，如果需要表示引号，请使用[]或其他替代符号，或者使用转义字符\\"
10. 仅输出JSON格式内容，直接以[]作为开头结尾
11. 不添加任何额外文本、注释或代码块标记

### 参考事件：
{reference_events}
'''

template_third_round_events = '''
请生成18-33个左右基于人群特征分析/常识知识推测/画像信息推测的事件，聚焦于（基于人群特征分析所属人群）和依据常理一年中会发生的事（基于常识知识推测）和一句画像信息推测的事件。注意时间线的时间，应都在2025年。请避免生成日常类事件，事件应当具有一定意义或新颖性或特殊性或重要性或较长时间跨度（满足一项即可），并且**必须避免与当前时间线中的事件在时间上发生冲突**。

## 输入数据

### 人物画像
{persona}

### 当前时间线
{timeline}

## 任务要求

1. **事件类型**：
   - **人群特征导向事件（Demographics-Based）**：根据性别、年龄、职业、地域、教育背景等人群特征分析所属人群，生成符合该人群典型行为的事件
     * 按性别区分：女性美容保养、男性体育竞技等
     * 按年龄区分：青少年学业成长、中年职场发展、老年健康养生等
     * 按职业区分：学生考试实习、教师教研进修、医生值班手术等
     * 按地域区分：北方冬季保暖、南方雨季防护、沿海海鲜饮食等
   - **常识性年度事件（Commonsense Annual）**：基于常识知识推测一年中必然或大概率发生的事件，可基于共性特征或个人画像特征
     * 季节性事件：春夏秋冬四季活动、换季衣物整理等
     * 重要的周期性事件：体检复查、缴费续费、合同续签等（不包括每日通勤等琐碎事件）
     * 个人画像相关事件：基于个人具体特征（如健康状况、兴趣爱好、生活习惯等）推测的可能发生的年度事件
     * 身边人可能会发生的事件：基于身边人特征（如健康状况、兴趣爱好、生活习惯等）推测的可能发生的事件
   - **基于画像生成其他可能发生的事件**
     * 基于人物画像个人信息特征推测的可能发生的事件（如工作学习、兴趣爱好、休闲娱乐、生活家庭等）
     * 基于人物画像社交关系和周围环境特征推测的可能发生的事件（如社交活动，他人事件等）
     * 生成能够较好体现人物的画像信息（如工作、爱好、关系等信息）的事件
     
2. **事件信息**：
   - 每个事件需要包含：事件名称、事件描述、起始时间、结束时间
   - 时间范围需要设定在2025年内
   - 时间安排上尽量避免与当前时间线中的已有事件发生冲突
   - 事件应基于人群特征分析和常识知识，可结合个人画像特征
   - 事件应体现所属人群的典型行为模式或个人画像的特定行为

3. **事件特点**：
   - 事件应具体、详细，包含明确的时间、地点、人物和活动内容
   - 事件应具有普遍性（反映同类人群的共性行为）或个性化（反映个人画像特征）
   - 事件应客观真实，符合生活逻辑和社会背景
   - 每个事件应展现独立的主题，与其他事件无直接关联
   - 事件应体现变化性，与已有时间线事件差异化
   - 事件应基于合理推断，而非虚构情节

4. **人群特征分析与常识推理**：
   - 仔细分析人物画像中的性别、年龄、职业、地域、教育背景等信息
   - 基于这些特征推断所属人群的典型行为模式
   - 推测一年中该人群或个人大概率经历的事件
   - 确保事件符合人群特征和常识规律，同时考虑个人画像特征

## 输出格式要求

请严格按照以下JSON数组格式输出，每个事件包含：
- name：事件名称
- description：事件详细描述
- start_time：事件起始时间（格式：YYYY-MM-DD HH:MM:SS 或 YYYY-MM-DD，必须是2025年）
- end_time：事件结束时间（格式：YYYY-MM-DD HH:MM:SS 或 YYYY-MM-DD，必须是2025年）
- type：事件类别（从以下9个类别中选择：Career、Education、Relationships、Family&Living Situation、Personal Life、Finance、Health、Unexpected Events、Other）
- event_analysis：详细分析产生这个事件的原因（基于人群特征分析和常识知识推测）和对人物画像及生活的影响分析

[  
  {{    
    "name": "事件名称",
    "description": "事件详细描述，包含时间、地点、人物和活动内容，以及事件的起因、经过和预期结果",
    "start_time": "2025-01-01 09:00:00",
    "end_time": "2025-01-01 12:00:00",
    "type": "Career",
    "event_analysis": "详细分析产生这个事件的原因（基于人群特征分析和常识知识推测）和对人物画像及生活的影响分析"
  }}
]

## 注意事项

1. 严格遵循JSON格式规范，确保输出可被正确解析
2. 事件的发生时间要多样，可以均匀在各个月份，不要过于密集。
3. 事件应基于人群特征分析和常识知识推测，可结合个人画像特征
4. 重点关注普遍性和合理性，每个事件应反映同类人群的典型行为或个人画像特征
5. 确保不同事件间主题独立，避免相互关联
6. 避免与现有时间线中的事件重复，要体现差异化变化
7. **重要要求：时间安排上必须避免与当前时间线中的已有事件发生冲突**
8. 事件必须发生在2025年，展现一年的生活变化发展
8. 保证和前两轮事件都不重复
9. 重点分析人群特征和常识知识，确保事件符合所属人群的行为模式或个人画像特征
10. 仅输出JSON格式内容，直接以[]作为开头结尾
11. 不添加任何额外文本、注释或代码块标记
12. **特别注意**：在JSON字符串值中避免使用双引号，如果需要表示引号，请使用[]或其他替代符号，或者使用转义字符\\"
'''

template_analyze_group_events = '''
请对以下事件组进行专业分析，筛选出合理事件，并对筛选出的事件进行扩展丰富与优化、分析影响以及完整的事件发展脉络与体现。

## 输入数据

### 人物画像
{persona}

### 当前时间线
{timeline}

### 待分析事件组
{event_group}

## 任务要求

1. **事件筛选标准**：
   - 选取真实合理的事件（人物画像可存在合理变化，如结识新朋友、培养新爱好等，变化需基于原有人物特征合理推演）
   - 摒弃过于戏剧化、脱离现实的事件
   - 避免与人物性格严重不符或变化过于频繁的事件
   - 剔除与现有时间线重复或存在逻辑冲突的事件

2. **事件深度分析与优化**：
   - 解析事件产生的根本原因与触发条件
   - 评估事件对人物的真实影响与后续效应
   - 识别潜在的前置事件、后续发展与关联事件
   - 梳理事件间的逻辑关系与内在联系
   - 思考事件的体现
   - 对事件进行优化重写丰富，同时思考事件发生的时间、内容多样。

3. **事件链条扩展**：
   - 对重要事件，需深入推演其后续体现与延伸发展
   - 构建完整的事件因果链条，思考事件间的连锁反应
   - 事件发展可呈现多种模式，包括但不限于：
     * 无后续发展（放弃、转向其他方向）
     * 先抑后扬（初期遇到阻碍，后续取得进展）
     * 种桃得李（产生预期外的积极成果）
     * 线性发展（持续推进、逐步深化）
   - 所有前置事件、后续发展、关联事件、顺序事件、体现事件与并列事件均需纳入event_sequence数组
   - 事件关系类型说明：
     * 因果关系（causal）：事件间存在直接因果关联（如3月启动项目→5月出差调研→7月项目成功+出差顺利→获得晋升→8月涨薪购车→10月与新上司建立联系）
     * 相关关系（correlative）：事件间存在某种关联，但非直接因果关系
     * 顺序关系（sequential）：事件按时间顺序发生，但无直接逻辑关联
     * 体现关系（manifestation）：事件体现了另一事件的影响或结果（如3月结识摄影好友→5月相约摄影→7月咨询设备选购→9月关系升温→12月互赠礼物）
     * 并列关系（parallel）：性质相似但无直接逻辑关联的同类事件（如7月购买化妆品→8月美容护理→9月按摩放松）
   - 确保事件发展与原时间线无冲突
   - 非关键/重要事件可保持简洁，无需强制扩展前置/后置事件，event_sequence仅包含原事件即可

4. **输出内容要求**：
   - 输出经筛选与分析的事件数组
   - 包含事件名称、详细描述、起止时间、影响分析等关键信息
   - 控制事件粒度，避免过于琐碎的细节，事件序列可表述一个阶段的整体事件，不要求细化到具体行动。

## 输出格式要求

请严格遵循以下JSON格式输出，各字段类型与说明如下：

[
  {{
    "name": "字符串，筛选后事件的核心名称",
    "theme_summary": "字符串，该事件序列的主题概述",
    "event_sequence": [
      {{
        "name": "字符串，相关事件的具体名称",
        "description": "字符串，事件的详细描述",
        "start_time": "字符串，事件开始时间，格式：YYYY-MM-DD HH:MM:SS",
        "end_time": "字符串，事件结束时间，格式：YYYY-MM-DD HH:MM:SS",
        "type": "字符串，事件类型"
      }}
    ]
  }}
]

**输出示例：**

[
  {{
    "name": "开始健身计划",
    "theme_summary": "健康与健身主题",
    "event_sequence": [
      {{
        "name": "开始健身计划",
        "description": "制定并开始执行每周三次的健身房锻炼计划",
        "start_time": "2025-03-15 08:00:00",
        "end_time": "2025-12-31 23:59:59",
        "type": "Personal Life"
      }},
      {{
        "name": "购买健身装备",
        "description": "购买运动服装、跑鞋和健身器材",
        "start_time": "2025-03-20 14:00:00",
        "end_time": "2025-03-20 16:00:00",
        "type": "Personal Life"
      }},
      {{
        "name": "参加健身课程",
        "description": "报名参加瑜伽和力量训练课程",
        "start_time": "2025-04-01 19:00:00",
        "end_time": "2025-06-30 20:00:00",
        "type": "Education"
      }}
    ]
  }}
]

## 注意事项

1. 严格遵循JSON格式规范，确保输出可被程序正确解析
2. 仅输出纯JSON格式内容，直接以JSON数组标记[]作为开头和结尾
3. 避免添加任何JSON格式外的文本、注释或代码块标记
4. 对于简单事件，可省略event_sequence字段
5. 确保事件名称、描述、时间等关键信息准确清晰
6. 确保事件的真实性与合理性，避免过度戏剧化
7. 兼顾事件发展的多样性与复杂性，体现生活的真实波动特性
8. 清晰区分各类事件关系，尤其是并列关系（例如：美容护理事件可与购买化妆品、按摩放松等同类事件并列）
9. **特别注意**：JSON字符串值中如需使用引号，请使用转义字符\\"或其他替代方式（如[]）
'''